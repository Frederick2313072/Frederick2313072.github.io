<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
    
    
      <link href="../../css/fonts.css" rel="stylesheet" type="text/css">
    
  

  
  <title>ICS-PAç¬”è®°</title>

  
  
  <link rel="stylesheet" href="../../css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="../../css/fork-awesome.min.css">
  

  
  
    <link href="https://Frederick2313072.github.io/favicon.png" rel="icon">
  

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="">
  <meta name="author" content="Frederick">

  
  <meta name="generator" content="Hugo 0.152.2">

  
  

  
  



</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="https://Frederick2313072.github.io/">Frederick</a></h1>
    <h2>Welcome to my Alter Ego&#39;s site!</h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigateâ€¦</option>
      
        <option value="https://Frederick2313072.github.io/about/">Â» About</option>
      
        <option value="https://Frederick2313072.github.io/links/">Â» Links</option>
      
        <option value="https://Frederick2313072.github.io/archives/">Â» Archives</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="https://Frederick2313072.github.io/about/" title="About"  target="_blank"  rel="noopener noreferrer">About</a></li>
    
  
    
      <li><a href="https://Frederick2313072.github.io/links/" title="Links"  target="_blank"  rel="noopener noreferrer">Links</a></li>
    
  
    
      <li><a href="https://Frederick2313072.github.io/archives/" title="Archives"  target="_blank"  rel="noopener noreferrer">Archives</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="https://Frederick2313072.github.io/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Mar 17, 2025
     - 7 minute read 
     - <a href="https://Frederick2313072.github.io/blog/2025-03-17-ics-pa%E7%AC%94%E8%AE%B0/#disqus_thread">Comments</a>

    
  </p>
  <h1 class="entry-title">
     ICS-PAç¬”è®° 
  </h1>
</header>


        <div class="entry-content">
          
          
          
          <p>Unix is a user-friendly. It&rsquo;s just selective about who its friends are.</p>
<h2 id="unixå“²å­¦">Unixå“²å­¦</h2>
<p>KISSï¼šKeep it simple,stupid.</p>
<p>Everything is a file and pipeline programs to work together.</p>
<p>æ¯ä¸ªå·¥å…·åªåšä¸€ä»¶äº‹æƒ…ï¼Œä½†åšåˆ°æè‡´</p>
<p>å°å·¥å…·ç»Ÿä¸€æ–‡æœ¬è¾“å…¥è¾“å‡ºï¼Œæ˜“äºä½¿ç”¨</p>
<p>ä½¿ç”¨ç®¡é“è¿›è¡Œç»„åˆ</p>
<p><img src="image-20250313120233047.png" alt=""></p>
<p>man -k xxx æ£€ç´¢å…³é”®å­—XXXçš„å‘½ä»¤</p>
<p>echo $?æŸ¥çœ‹ä¸Šä¸€æ¡æŒ‡ä»¤çš„é€€å‡ºçŠ¶æ€</p>
<p>gcc -E -S -c -o</p>
<p>.c -&gt; .i -&gt; .s -&gt; .o -&gt; .out</p>
<p>å…ƒç¼–ç¨‹ï¼šå®šä¹‰è‡ªå·±çš„è¯­è¨€ï¼Œä½†æ˜¯ä¸ç ´åå¯è¯»æ€§</p>
<p>å‡½æ•°çš„è°ƒç”¨å°±æ˜¯æ ˆçš„ç”Ÿé•¿</p>
<p>.o -&gt; .outå°±æ˜¯é‡å®šå‘çš„è¿‡ç¨‹ï¼Œ.oä¸çŸ¥é“æ‰€è°ƒç”¨å‡½æ•°ä½ç½®ï¼Œé“¾æ¥åå¡«å…¥å‡½æ•°åœ°å€ä¼šæœ‰åç§»</p>
<p>Cç¨‹åºæ‰§è¡Œçš„ä¸¤ä¸ªè§†è§’</p>
<ul>
<li>é™æ€ï¼šC ä»£ç çš„è¿ç»­ä¸€æ®µæ€»èƒ½å¯¹åº”åˆ°ä¸€æ®µè¿ç»­çš„æœºå™¨æŒ‡ä»¤</li>
<li>åŠ¨æ€ï¼šC ä»£ç æ‰§è¡Œçš„çŠ¶æ€æ€»èƒ½å¯¹åº”åˆ°æœºå™¨çš„çŠ¶æ€</li>
</ul>
<p>Segmentation faultæŠ¥é”™ï¼šå·²è¶…è¿‡è¿™å—å†…å­˜å…è®¸çš„æƒé™æ¥æ“ä½œ</p>
<p>å¤§å¤šæ•°æœºå™¨é‡‡ç”¨å°ç«¯ï¼Œå®¹æ˜“å¯¹é½</p>
<p>longåœ¨32ä½ä¸Šæ˜¯4ä¸ªå­—èŠ‚ï¼Œåœ¨64ä½æ˜¯8ä¸ªå­—èŠ‚</p>
<p>åªè¦æ˜¯ä¸ªæŒ‡é’ˆï¼Œ32ä½æœºå°±æ˜¯4ä¸ªå­—èŠ‚ï¼Œ64ä½å°±æ˜¯8ä¸ªå­—èŠ‚ï¼ŒæŒ‡é’ˆåœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ˜¯ä¸ªåœ°å€</p>
<pre tabindex="0"><code>void (*signal (int sig, void (*func)(int)))(int);
</code></pre><p>å‚æ•°ä¸º(int sig, void (*func)(int)),*å‡½æ•°è¿”å›å€¼ï¼Œä¸ºintå‹</p>
<h2 id="æ‹¿åˆ°é¡¹ç›®å">æ‹¿åˆ°é¡¹ç›®å</h2>
<p>makeæ„å»º</p>
<p>make runè·‘ä¸€ä¸‹</p>
<p>çœ‹çœ‹Makefileæ€ä¹ˆæ„å»ºçš„</p>
<p>å¤§è‡´äº†è§£ä¸‹é¡¹ç›®æ€»ä½“ç»“æ„</p>
<ul>
<li>tree</li>
<li>find &hellip; | xargs cat | wc â€“l</li>
</ul>
<p>å°†findæ‰¾åˆ°çš„æ–‡ä»¶åˆ—è¡¨ä¼ ç»™catï¼Œcatä¾æ¬¡è¯»å–æ–‡ä»¶å†…å®¹ï¼Œwc -lç»Ÿè®¡æ‰€æœ‰æ–‡ä»¶çš„æ€»è¡Œæ•°</p>
<pre tabindex="0"><code>find . -name &#34;*.c&#34; -o -name &#34;*.h&#34; | xargs cat | wc -l
</code></pre><p>266807</p>
<p>æ‰¾åˆ°å…¥å£ç‚¹main</p>
<pre tabindex="0"><code>grep -n main $(find . -name &#34;*.c&#34;)
</code></pre><p><img src="image-20250313201913865.png" alt=""></p>
<pre tabindex="0"><code> grep -nr &#34;\bmain\b&#34; nemu/src
</code></pre><p><img src="image-20250314111506176.png" alt=""></p>
<p>æ­£åˆ™è¡¨è¾¾å¼ï¼Œmainä»¥å•è¯å½¢å¼å‡ºç°</p>
<p>vim $(fzf)å¯ä»¥ä»¥æ ‘çš„æ–¹å¼ç›´æ¥è·³è½¬æŸä¸ªæ–‡ä»¶</p>
<p>(gdb)layout src :æ‰“å¼€æºç </p>
<p>ä¸¤ç§è¿è¡Œæ–¹å¼</p>
<ul>
<li>make run</li>
<li>./build/riscv32-nemu-interpreter</li>
</ul>
<p>æ€ä¹ˆç»™nemuä¼ æŒ‡ä»¤</p>
<ul>
<li>echo &lsquo;help&rsquo; | ./build/riscv32-nemu-interpreter</li>
<li>cat in.txt | ./build/riscv32-nemu-interpreter</li>
<li>./build/riscv32-nemu-interpreter &lt; in.txt</li>
</ul>
<p><img src="image-20250314133250320.png" alt=""></p>
<p>å›å½’æµ‹è¯•çš„è„šæœ¬ï¼Ÿ</p>
<p>parse_args()å‡½æ•°ï¼Œè§£æå‘½ä»¤è¡Œå‚æ•°</p>
<pre tabindex="0"><code>static int parse_args(int argc, char *argv[]) {
  const struct option table[] = {
    {&#34;batch&#34;    , no_argument      , NULL, &#39;b&#39;},
    {&#34;log&#34;      , required_argument, NULL, &#39;l&#39;},
    {&#34;diff&#34;     , required_argument, NULL, &#39;d&#39;},
    {&#34;port&#34;     , required_argument, NULL, &#39;p&#39;},
    {&#34;help&#34;     , no_argument      , NULL, &#39;h&#39;},
    {0          , 0                , NULL,  0 },
  };
  int o;
</code></pre><p>static</p>
<p>å¦‚æœåœ¨ä¸¤ä¸ªæ–‡ä»¶é‡Œå®šä¹‰äº†é‡åçš„å‡½æ•°ï¼Œèƒ½å¤Ÿåˆ†åˆ«ç™¾è¡²è¡£ï¼Œä½†é“¾æ¥ä¼šå‡ºé”™ï¼ŒåŠ äº†ä¸€ä¸ªstaticï¼Œçº¦æŸå¯è§çš„èŒƒå›´ï¼Œä½¿ä¸ä¼šè§¦å‘å‡½æ•°å¾—é‡åï¼Œnemuæ¡†æ¶å¾—é€»è¾‘ï¼šåªè¦æ˜¯å‡½æ•°å°±åŠ static</p>
<p>/riscv32/**/reg.h</p>
<pre tabindex="0"><code>#ifndef __RISCV_REG_H__
#define __RISCV_REG_H__

#include &lt;common.h&gt;

static inline int check_reg_idx(int idx) {
  IFDEF(CONFIG_RT_CHECK, assert(idx &gt;= 0 &amp;&amp; idx &lt; MUXDEF(CONFIG_RVE, 16, 32)));
  return idx;
}

#define gpr(idx) (cpu.gpr[check_reg_idx(idx)])

static inline const char* reg_name(int idx) {
  extern const char* regs[];
  return regs[check_reg_idx(idx)];
}

#endif
        
</code></pre><p>â€‹</p>
<p>è¿è¡Œæ—¶é—´çŸ­ï¼Œä½†æ˜¯è°ƒç”¨é¢‘ç¹ï¼Œstatic inline intå»ºè®®ç¼–è¯‘å™¨ç”¨å†…è”å‡½æ•°çš„æ–¹å¼å±•å¼€ï¼Œä¸è°ƒç”¨å‡½æ•°ï¼Œè€Œæ˜¯åœ¨è°ƒç”¨ç‚¹ç›´æ¥å±•å¼€ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´</p>
<p>monitor.c</p>
<pre tabindex="0"><code>
void init_monitor(int argc, char *argv[]) {
  /* Perform some global initialization. */

  /* Parse arguments. */
  parse_args(argc, argv);

  /* Set random seed. */
  init_rand();

  /* Open the log file. */
  init_log(log_file);

  /* Initialize memory. */
  init_mem();

  /* Initialize devices. */
  IFDEF(CONFIG_DEVICE, init_device());

  /* Perform ISA dependent initialization. */
  init_isa();

  /* Load the image to memory. This will overwrite the built-in image. */
  long img_size = load_img();

  /* Initialize differential testing. */
  init_difftest(diff_so_file, img_size, difftest_port);

  /* Initialize the simple debugger. */
  init_sdb();

  IFDEF(CONFIG_ITRACE, init_disasm());

  /* Display welcome message. */
  welcome();
}
</code></pre><p>äººæœºäº¤äº’ï¼Œä»¥é»˜è®¤è¡Œç¼“å†²çš„æ–¹å¼äº¤äº’ï¼Œæ²¡æœ‰æ¢è¡Œç¬¦æ˜¯ä¸ä¼šè¿›è¡ŒI/Oäº¤äº’ï¼Œæ¯è¯»åˆ°ä¸€ä¸ªæ¢è¡Œç¬¦\nï¼Œå°±ä¼šé‡Šæ”¾ç¼“å†²åŒº</p>
<p>**/debug.h</p>
<pre tabindex="0"><code>#include &lt;common.h&gt;
#include &lt;stdio.h&gt;
#include &lt;utils.h&gt;

#define Log(format, ...) \
    _Log(ANSI_FMT(&#34;[%s:%d %s] &#34; format, ANSI_FG_BLUE) &#34;\n&#34;, \
        __FILE__, __LINE__, __func__, ## __VA_ARGS__)

#define Assert(cond, format, ...) \
  do { \
    if (!(cond)) { \
      MUXDEF(CONFIG_TARGET_AM, printf(ANSI_FMT(format, ANSI_FG_RED) &#34;\n&#34;, ## __VA_ARGS__), \
        (fflush(stdout), fprintf(stderr, ANSI_FMT(format, ANSI_FG_RED) &#34;\n&#34;, ##  __VA_ARGS__))); \
      IFNDEF(CONFIG_TARGET_AM, extern FILE* log_fp; fflush(log_fp)); \
      extern void assert_fail_msg(); \
      assert_fail_msg(); \
      assert(cond); \
    } \
  } while (0)

#define panic(format, ...) Assert(0, format, ## __VA_ARGS__)

#define TODO() panic(&#34;please implement me&#34;)

#endif
</code></pre><p>#define assert(cond) if(!(cond)) panic(&hellip;.);</p>
<p>å®çš„å±•å¼€å¯èƒ½ä¼šæ‰“ä¹±è®¡ç®—çš„ä¼˜å…ˆçº§é¡ºåºï¼Œä½¿ç”¨do{}while(0)æ˜¯ä¸ºäº†é˜²æ­¢å®å±•å¼€æ‰“ç ´ã€‚</p>
<p>Kconfigç®¡ç†é…ç½®å®</p>
<h2 id="æ•°æ®çš„æœºå™¨çº§è¡¨è¿°">æ•°æ®çš„æœºå™¨çº§è¡¨è¿°</h2>
<p>å¦‚ä½•å–å­—èŠ‚ï¼Ÿ</p>
<p>å¦‚x=0101ï¼Œè¦æŠŠå³è¾¹ç¬¬äºŒä½å–å‡ºæ¥ï¼Œ(x&raquo;1)&amp;1</p>
<p>å†å¦‚</p>
<p><img src="image-20250314193757661.png" alt=""></p>
<p>(x&raquo;16)&amp;11111111</p>
<p>å°±æ˜¯ä¸¢æ‰ä¸ç”¨çš„ä½</p>
<p>äº¤æ¢é«˜/ä½16ä½((x &amp; 0xFFFF)&laquo;16)ï¼Œ((x&raquo;16)&amp;0xFFFF)</p>
<p>æµ‹è¯•ğ‘¥ âˆˆ ğ‘†ï¼Œ(S &raquo; x) &amp; 1</p>
<p>æ±‚ ğ‘†! = ğ‘† âˆª {ğ‘¥}ï¼ŒS | (1 &laquo; x)</p>
<p>æ±‚|S|ï¼ŒSäºŒè¿›åˆ¶è¡¨ç¤ºæœ‰å¤šå°‘ä¸ª1</p>
<h2 id="å•æŒ‡ä»¤å¤šæ•°æ®">å•æŒ‡ä»¤å¤šæ•°æ®</h2>
<p>&amp;ï¼Œ|ï¼Œ~å¯¹äºæ•´æ•°é‡Œçš„æ¯ä¸€ä¸ªbitæ¥è¯´æ˜¯ç‹¬ç«‹ï¼ˆå¹¶è¡Œï¼‰çš„</p>
<p>Bit Set</p>
<p>ä»»æ„ä½ï¼Œä½è¿ç®—æ˜¯å¯¹æ‰€æœ‰bitåŒæ—¶å®Œæˆçš„ï¼Œçœç©ºé—´ï¼Œç¨‹åºæ‰§è¡Œä¸­ï¼Œå†…å­˜ä¼˜å…ˆçº§ä¸åŒï¼Œé€Ÿåº¦ä¸åŒï¼Œå¯¹cacheçš„å ç”¨æ¯”è¾ƒå°</p>
<p>è¡¥ç ï¼šå„ä½å–åæœ«å°¾åŠ ä¸€</p>
<h2 id="undefined-behaviour">Undefined Behaviour</h2>
<p>è­¦æƒ•æ•´æ•°æº¢å‡º</p>
<p>ç§»ä½æ“ä½œä¸èƒ½è¶…å‡ºæ•°æ®é•¿åº¦</p>
<p>å¦‚æœæœ‰UBè¡Œä¸ºï¼Œç”¨ä¸åŒgccä¼˜åŒ–è¡Œä¸ºï¼Œè¾“å‡ºæ˜¯ä¸ç¡®å®šçš„</p>
<p><img src="image-20250314205940749.png" alt=""></p>
<p>å¦‚æœåœ¨è¯•å›¾è®¿é—®ä¸€å—å†…å­˜æ—¶ï¼Œè®¿é—®åˆ°è¿™å—å†…å­˜ä¹‹å¤–çš„ä¸€å—å†…å­˜ï¼Œæ¯”å¦‚æ•°ç»„è¶Šç•Œï¼Œä½†æ˜¯è¿˜æ˜¯åœ¨æ ˆä¸Šï¼Œå¯èƒ½æ˜¯é¡µçš„è¾¹ç•Œè¯»åˆ°äº†å€¼</p>
<p>ç¼–è¯‘å™¨ä¼˜åŒ– -fsanitize</p>
<p>å¦‚ä½•å®ç°åœ¨æ¯ä¸€æ¬¡æŒ‡é’ˆè®¿é—®æ—¶ï¼Œéƒ½å¢åŠ ä¸€ä¸ªæ–­è¨€assert(obj-&gt;low &lt;= ptr &amp;&amp; ptr &lt; obj-&gt;high);</p>
<pre tabindex="0"><code>gcc â€“fsanitize=undefined a.c &amp;&amp; ./a.out
</code></pre><h2 id="abiå’Œå†…è”æ±‡ç¼–">ABIå’Œå†…è”æ±‡ç¼–</h2>
<p>æœºå™¨å­—é•¿å¼å¤„ç†å™¨èƒ½å¤Ÿç›´æ¥è¿›è¡Œæ•´æ•°æˆ–è€…ä½è¿ç®—å¤§å°ï¼Œä»£è¡¨ä¸€ä¸ªæŒ‡é’ˆæœ€å¤šå¤šå°‘ä½</p>
<p>ç°åœ¨å¤„ç†å™¨ä¸€èˆ¬å®ç°48bitç‰©ç†åœ°å€</p>
<p>æ™¶ä½“ç®¡æ˜¯ä»¥æ•°å­—é€»è¾‘ç”µè·¯å½¢å¼ï¼Œlogic unitsç»„æˆè®¡ç®—å•å…ƒï¼Œ&hellip;.ï¼ŒåŒ…å«åœ¨ALUä¸­ï¼Œæ±‡ç¼–å™¨å¦‚ä½•ç¿»è¯‘ï¼Œç¡¬ä»¶å¦‚ä½•è§£è¯»01ä¸²ï¼Œè¦éµå¾ªISAåè®®</p>
<p>QAï¼šåªè¦æœ‰ISAåè®®çœŸçš„è¶³å¤Ÿäº†å—ï¼Ÿ</p>
<p>éœ€è¦ABI</p>
<p><img src="image-20250314222038292.png" alt=""></p>
<p>çº¦å®šbinaryçš„è¡Œä¸º</p>
<ul>
<li>äºŒè¿›åˆ¶æ–‡ä»¶çš„æ ¼å¼</li>
<li>å‡½æ•°è°ƒç”¨ï¼Œç³»ç»Ÿè°ƒç”¨ï¼Œå¦‚printféœ€è¦å€ŸåŠ©å¤–éƒ¨çš„åº“å‡½æ•°ï¼Œå¦‚libc</li>
<li>é“¾æ¥ï¼ŒåŠ è½½</li>
</ul>
<h2 id="cdeclå‡½æ•°è°ƒç”¨">cdeclå‡½æ•°è°ƒç”¨</h2>
<p>caller stack frame</p>
<ul>
<li>æ‰€æœ‰å‚æ•°éƒ½ä»¥æ•°ç»„çš„å½¢å¼ä¿å­˜åœ¨å †æ ˆä¸Šï¼Œä¾‹å­ï¼Œååºå‹æ ˆï¼Œf(x,y)ï¼Œy,x,fä»é«˜åœ°å€åˆ°ä½åœ°å€</li>
<li>è¿”å›åœ°å€</li>
<li>è·³è½¬åˆ°callee</li>
</ul>
<p>è°ƒç”¨æ–¹å¯„å­˜å™¨%eax,%ebx,%ecd,è¢«è°ƒç”¨æ–¹å¯„å­˜å™¨%ediï¼Œå…ˆå­˜ä¸‹æ¥ï¼Œå‡½æ•°é€€å‡ºæ—¶è¦æ¢å¤è°ƒç”¨å‰çš„å€¼ï¼Œè°ƒç”¨æ–¹è´Ÿè´£ååºå‹æ ˆï¼Œè¢«è°ƒç”¨æ–¹è´Ÿè´£æ‰§è¡Œå°±è¡Œ</p>
<p><img src="image-20250314231647133.png" alt=""></p>
<p>OSï¼Œæ ˆï¼Œ&hellip;&hellip;ï¼Œå †ï¼Œdataï¼Œä»£ç ï¼Œ</p>
<p>PCæŒ‡å‘ä»£ç å—</p>
<p>åœ¨X86ä¸Šï¼Œå¯„å­˜å™¨æ•°é‡æœ‰é™ï¼ŒåŸºäºæ ˆä¼ å‚</p>
<p><img src="image-20250315094933212.png" alt=""></p>
<p>ä½¿ç”¨å¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼šrdi,rsi,rdx,rcx,r8,r9</p>
<ul>
<li>calleeå¯ä»¥éšæ„ä¿®æ”¹è¿™6ä¸ªå¯„å­˜å™¨çš„å€¼</li>
<li>ç¼–è¯‘å™¨æœ‰äº†æ›´å¤§çš„è°ƒåº¦ç©ºé—´</li>
</ul>
<p>äº¤æ¢ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„æ•°å­—</p>
<p><img src="image-20250315101104356.png" alt=""></p>
<h2 id="ioè®¾å¤‡">I/Oè®¾å¤‡</h2>
<p>è®¾å¤‡=ä¸€ç»„å¯„å­˜å™¨ï¼Œæ¯æ¬¡å¯ä»¥äº¤æ¢ä¸€å®šæ•°é‡çš„æ•°æ®</p>
<p>è®¾å¤‡-å¤„ç†å™¨æ¥å£</p>
<p>CPUé€šè¿‡PMIO.PIOè®¿é—®</p>
<p>Port-mapped I/O (PMIO) //å¾ˆè€çš„åšæ³•</p>
<p>CPUå’Œå†…å­˜åœ°å€åˆ†ç¦»ï¼Ÿ</p>
<p>â€¢ I/Oåœ°å€ç©ºé—´ï¼ˆportï¼‰
â€¢ CPUç›´è¿I/Oæ€»çº¿</p>
<p><img src="image-20250315114438017.png" alt=""></p>
<p>Memory-mapped I/O(MMIO)</p>
<ul>
<li>ç›´è§‚:ä½¿ç”¨æ™®é€šå†…å­˜è¯»å†™æŒ‡ä»¤</li>
<li>å¸¦æ¥ä¸€äº›è®¾è®¡å’Œå®ç°çš„éº»çƒ¦ï¼Œç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œä¹±åºæ‰§è¡Œ</li>
<li><img src="image-20250315114750121.png" alt=""></li>
</ul>
<p>80så¦‚ä½•æ‰“å°ï¼Ÿ</p>
<p>ä¸æ˜¯å‘é€æ•°æ®ï¼Œè€Œæ˜¯æ‰§è¡ŒæŒ‡ä»¤</p>
<h2 id="ä¸¤ä¸ªç‰¹æ®Šçš„ioè®¾å¤‡">ä¸¤ä¸ªç‰¹æ®Šçš„I/Oè®¾å¤‡</h2>
<p>æ€»çº¿</p>
<ul>
<li>PCIæ€»çº¿åè®®</li>
<li>CPUè¿æ¥æ€»çº¿</li>
<li>æ€»çº¿è¿æ¥å…¶ä»–æ€»çº¿</li>
</ul>
<p>ä¸­æ–­æ§åˆ¶å™¨</p>
<ul>
<li>
<p>ä¸­æ–­è®¾è®¡æ˜¯ä¸ºäº†å¼¥è¡¥I/Oè®¾å¤‡çš„é€Ÿåº¦ç¼ºé™·</p>
</li>
<li>
<p>ç®¡ç†å¤šä¸ªäº§ç”Ÿä¸­æ–­çš„è®¾å¤‡</p>
</li>
<li>
<p>æ±‡æ€»æˆä¸€ä¸ªä¸­æ–­ä¿¡å·ç»™CPU</p>
</li>
<li>
<p>æ”¯æŒä¸­æ–­çš„å±è”½ï¼Œä¼˜å…ˆçº§ç®¡ç†ç­‰</p>
</li>
<li>
<p>ä¸­æ–­=ç¡¬ä»¶é©±åŠ¨çš„å‡½æ•°è°ƒç”¨ï¼Œç›¸å½“äºåœ¨æ¯æ¡è¯­å¥åéƒ½æ’å…¥intterrupt_handler();</p>
<p>æ ˆå’Œå †ä¹‹é—´çš„ç©ºé—²åŒºåŸŸåšæ–‡ä»¶æ˜ å°„ï¼Œl.bc.so,mapç³»ç»Ÿè°ƒç”¨æ˜ å°„åŒæ­¥</p>
</li>
</ul>
<p><img src="image-20250315124507710.png" alt=""></p>
<p>ä¸­æ–­ï¼Œä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼ŒåŒä¸€ä¸ªCPUä¸Šå¯ä»¥åšä¸åŒä»»åŠ¡ï¼Œå¤šçº¿ç¨‹</p>
<p><img src="image-20250315125258677.png" alt=""></p>
<p>è¿›ç¨‹=åˆ†æ—¶å¤šçº¿ç¨‹+è™šæ‹Ÿå­˜å‚¨</p>
<h2 id="é“¾æ¥ä¸åŠ è½½">é“¾æ¥ä¸åŠ è½½</h2>
<p>0001 0100 jmp 0100 ;å¦‚æœå‘ç”Ÿåç§»æ€ä¹ˆåŠï¼Ÿ</p>
<p>0001 0000 jmp foo;å€ŸåŠ©ç¬¦å·è¡¨è·³è½¬ï¼Œæ¨¡å—åŒ–å¥½</p>
<h2 id="å¤ä¹ ä¸€ä¸‹elfæ–‡ä»¶">å¤ä¹ ä¸€ä¸‹ELFæ–‡ä»¶ï¼Ÿ</h2>
<p>å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶
â€¢ ELF å¤´
å®šä¹‰äº†ELFé­”æ•°ã€ç‰ˆæœ¬ã€å°ç«¯/å¤§ç«¯ã€æ“ä½œç³»ç»Ÿå¹³å°ã€ç›®æ ‡æ–‡ä»¶çš„ç±»å‹ã€æœºå™¨ç»“æ„ç±»å‹ã€èŠ‚å¤´è¡¨çš„èµ·å§‹ä½ç½®å’Œé•¿åº¦ç­‰
â€¢ .text èŠ‚
ç¼–è¯‘æ±‡ç¼–åçš„ä»£ç éƒ¨åˆ†
â€¢ .rodata èŠ‚
åªè¯»æ•°æ®ï¼Œå¦‚ printf æ ¼å¼ä¸²ã€switch è·³è½¬è¡¨ç­‰
â€¢ .data èŠ‚
å·²åˆå§‹åŒ–ä¸”åˆå€¼ä¸ä¸º0çš„å…¨å±€/é™æ€å˜é‡
â€¢ .bss èŠ‚
æœªåˆå§‹åŒ–æˆ–åˆå€¼ä¸º0çš„å…¨å±€/é™æ€å˜é‡ï¼Œä»…æ˜¯å ä½ç¬¦ï¼Œä¸å ä»»ä½•å®é™…ç£ç›˜ç©ºé—´ã€‚åŒºåˆ†bssèŠ‚æ˜¯ä¸ºäº†ç©ºé—´æ•ˆç‡</p>
<p>QA:ä¸ºä»€ä¹ˆbssèŠ‚ä¸å ä»»ä½•å®é™…ç£ç›˜ç©ºé—´ï¼Ÿ</p>
<p>åªæœ‰åœ¨è¿è¡Œçš„æ—¶å€™æ‰ä¼šåœ¨æ ˆä¸Šåˆ†é…ç©ºé—´å»ç”¨ï¼Œä¸è¢«å…¶ä»–å¤–éƒ¨æ–‡ä»¶æ‰€è®¿é—®</p>
<p>QAï¼šä¸ºä»€ä¹ˆè¦æŠŠç¨‹åºå’ŒæŒ‡ä»¤åˆ†å¼€æ”¾ï¼Ÿ</p>
<ul>
<li>æŒ‡ä»¤cacheå¯æ‰§è¡Œä¸å¯è¯»ä¸å¯å†™ï¼Œæ•°æ®cacheå¯è¯»/å¯å†™</li>
<li>æ•°æ®ä¼šå¾ˆå¤šæ¬¡è¦†ç›–ï¼Œä½†æ˜¯æŒ‡ä»¤ä¸ä¼šè¢«åå¤è¦†ç›–ï¼Œä¸‹æ¬¡å†æ¬¡ç¼“å­˜å‘½ä¸­ï¼Œä¸ä¼šå› ä¸ºæ•°æ®è¦†ç›–è€ŒæŒ‡ä»¤cacheæ¸…ç©º</li>
</ul>
<p>ç¬¦å·è§£æå’Œé‡å®šä½
â€¢ ç¡®å®šæ ‡å·å¼•ç”¨å…³ç³»
â€¢ å¦‚ä½•å¡«ç©ºï¼Ÿ</p>
<p><img src="image-20250315145211978.png" alt=""></p>
<p>å› ä¸ºå°ç«¯æ³•ï¼Œyçš„åœ°å€0x2ea5+116f</p>
<p>staticé“¾æ¥</p>
<ul>
<li>æŒ‰ç…§ç›¸åŒæ–‡ä»¶æŠŠä¸‰ä¸ªlocatableæ–‡ä»¶ç»„åˆï¼Œå¤–éƒ¨ç¬¦å·</li>
</ul>
<p>QAï¼šèƒ½å¦ç›´æ¥ç”¨ldé“¾æ¥ï¼Œå¦‚ld a.o b.o?</p>
<p>ä¸è¡Œï¼Œæ²¡æœ‰é“¾æ¥æ ‡å‡†åº“ï¼Œæ‰¾ä¸åˆ°_start,mainç­‰å‡½æ•°</p>
<p>è·‘ä¸€ä¸ª.outæ–‡ä»¶ï¼Ÿ</p>
<p>åˆ†é…ä¸€ä¸ªè¿›ç¨‹å†…å­˜ï¼Œå¯æ‰§è¡Œæ–‡ä»¶ä¸è™šæ‹Ÿåœ°å€ç©ºé—´é—´çš„å­˜å‚¨å™¨æ˜ åƒç”±ABIè§„èŒƒå®šä¹‰</p>
<p><img src="image-20250315153229274.png" alt=""></p>
<p>ä¸ºä»€ä¹ˆè¦åŠ¨æ€é“¾æ¥ï¼Ÿå»æ‰-fno-picå’Œstatic</p>
<p>å ç”¨ç©ºé—´æ›´å°</p>
<p>åªç”¨ç»´æŠ¤è¡¨å°±è¡Œ</p>
<ul>
<li>GOTè¡¨</li>
</ul>
<p>call *table[PRINTF]</p>
<ul>
<li>å»¶è¿Ÿç»‘å®šä½¿ç”¨PLTè¡¨æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</li>
</ul>
<p>åªæœ‰è°ƒç”¨åˆ°çš„å‡½æ•°ï¼Œæ‰å»å›å¡«è·³è½¬</p>
<pre tabindex="0"><code>printf@plt:
jmp *table[PRINTF]
push $PRINTF
call resolve
</code></pre><h2 id="ä¸­æ–­ä¸åˆ†æ—¶å¤šä»»åŠ¡">ä¸­æ–­ä¸åˆ†æ—¶å¤šä»»åŠ¡</h2>
<p>QAï¼šwhile(1);æ˜¯å¦ä¼šæŠŠç”µè„‘å¡æ­»ï¼Ÿ</p>
<p>ç±»ä¼¼äºcallæŒ‡ä»¤ï¼Ÿå‘ç”Ÿä¸­æ–­å¤„ç†ï¼Œå†è¿”å›ret</p>
<p>ä¸­æ–­å¤„ç†</p>
<ul>
<li>è‡ªåŠ¨ä¿å­˜RIP,CS,RFLAGS,RSP,SS,Error Code</li>
<li>æ ¹æ®ä¸­æ–­/å¼‚å¸¸å¥½è·³è½¬åˆ°å¤„ç†ç¨‹åºï¼Œç‰¹æƒçº§åˆ‡æ¢å›è§¦å‘å †æ ˆåˆ‡æ¢</li>
</ul>
<p>int $0x80å¯ä»¥äº§ç”Ÿ128å·å¼‚å¸¸ï¼Œä¸»åŠ¨å”¤èµ·ä¸­æ–­</p>
<p>æ—¶é’Ÿï¼Œé”®ç›˜32å·ä¸­æ–­ï¼ˆIDTï¼‰</p>
<p>CLI:Clear Interrupt Flag å…³ä¸­æ–­ï¼Œä¸æ˜¯ç»™ä½æƒé™ç”¨çš„ï¼Œ</p>
<p>ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰“æ–­ç‚¹ï¼ŒintæŒ‡ä»¤éƒ½æ˜¯ç¨‹åºå†…éƒ¨å¼•å‘å¼‚å¸¸</p>
<p>ä¸€ç±»æ˜¯å¯å¤„ç†ï¼Œæœ€ç»ˆè¿˜å¾—å›åˆ°ä¸­æ–­å‘ç”Ÿå¤„next PCï¼Œä¿å­˜ç°åœºï¼Œæ¢å¤ç°åœºï¼ˆåˆ†æ—¶å¤šä»»åŠ¡ï¼Œæ—¶é’Ÿä¸­æ–­éƒ½æ˜¯è¿™ç§ï¼‰</p>
<p>è€Œä¸å¯æ¢å¤çš„ï¼Œç¨‹åºå‡ºé”™ï¼Œè§¦å‘ERROR CODE0</p>
<p>QA:ä¿å­˜ç°åœºï¼Œæ¢å¤ç°åœº ä»€ä¹ˆå€¼ï¼Ÿ</p>
<p><img src="image-20250316135048155.png" alt=""></p>

        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">Frederick</span></span>
    
    <time>Mar 17, 2025</time>
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://Frederick2313072.github.io/blog/2025-03-16-jyy%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="jyyæ“ä½œç³»ç»Ÿ">jyyæ“ä½œç³»ç»Ÿ</a>
    

    
      <a class="basic-alignment right" href="https://Frederick2313072.github.io/blog/2025-03-21-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" title="æ•°æ®ç»“æ„ä¸ç®—æ³•">æ•°æ®ç»“æ„ä¸ç®—æ³•</a>
    
  </p>
  
    
      <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
  
</footer>


      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    
      <h1>About me</h1>
    

    <p>
      
        <p>2023å—å¼€DSåœ¨è¯»</p>
<p>ç›®å‰åœ¨TJUNLP</p>
<p>æ„Ÿå…´è¶£çš„æ–¹å‘ï¼šNLP,OS,LLM,Security</p>
<p>æœ€å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€ï¼šRust<br>
Click on 
<a href="../../about/">About</a> to know more.</p>

      
    </p>
  </section>

  
  



<ul class="sidebar-nav">
  <li class="sidebar-nav-item">
    <a target="_blank" rel="noopener noreferrer" href="https://github.com/Frederick2313072" title="https://github.com/Frederick2313072"><i class="fa fa-github fa-3x"></i></a>
    
    
    
    
    
    
    
    
    
    
    

  
  
  </li>
</ul>

  

  
    
      <section class="odd">
        
          <h1>Collections</h1>
        
        
          <li>
            <a href="https://Frederick2313072.github.io/categories/golang/" title="Hugo category" >Hugo category</a>
          </li>
        
      </section>
    
  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
          
            
              <li class="post">
                <a href="../../blog/2025-12-19-heart/">heart?</a>
              </li>
            
          
            
          
            
              <li class="post">
                <a href="../../blog/2025-12-19-%E6%B2%89%E6%80%9D%E5%BD%95/">æ²‰æ€å½•</a>
              </li>
            
          
            
              <li class="post">
                <a href="../../blog/2025-12-15-0g%E5%AE%98%E6%96%B9docs%E5%90%88%E7%BA%A6%E6%BC%8F%E6%B4%9E/">0gå®˜æ–¹docsåˆçº¦æ¼æ´</a>
              </li>
            
          
            
              <li class="post">
                <a href="../../blog/2025-09-02-%E9%98%85%E8%AF%BBpaper%E7%9A%84%E4%B8%80%E4%BA%9B%E6%83%B3%E6%B3%95/">é˜…è¯»paperçš„ä¸€äº›æƒ³æ³•</a>
              </li>
            
          
        </ul>
      </section>
    
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2025 Frederick - <a href="https://Frederick2313072.github.io/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    



    
    
    

    
  </body>
</html>

